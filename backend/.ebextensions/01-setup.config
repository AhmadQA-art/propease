option_settings:
  # Application Settings
  aws:elasticbeanstalk:container:nodejs:
    NodeCommand: npm start
  # Environment variables
  aws:elasticbeanstalk:application:environment:
    NODE_ENV: production
    PORT: 8081
    NODE_VERSION: 20
    
container_commands:
  01_install_node:
    command: |
      curl -fsSL https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash
      export NVM_DIR="$HOME/.nvm"
      [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
      nvm install 20
      nvm use 20
      nvm alias default 20
      echo "Node.js version set to: $(node -v)"
  02_npm_install:
    command: "npm ci --production" 