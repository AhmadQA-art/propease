// PropEase Database Schema DBML
// Auto-generated using Python script

Project PropEase {
  database_type: 'PostgreSQL'
  Note: 'PropEase Property Management System Database Schema'
}

Table activity_logs {
  id uuid [default: gen_random_uuid()] [not null]
  organization_id uuid [not null]
  property_id uuid
  unit_id uuid
  user_id uuid
  activity_type varchar(100) [not null]
  description text [not null]
  metadata jsonb
  created_at timestamp with time zone [default: now()]

  indexes {
    unique (id) [name: 'activity_logs_pkey']
  }
}

Table announcement_schedules {
  id uuid [default: gen_random_uuid()] [not null]
  announcement_id uuid [not null]
  start_date timestamp with time zone [not null]
  end_date timestamp with time zone
  repeat_frequency text
  repeat_on jsonb
  time_of_day time without time zone [not null]
  next_run timestamp with time zone [not null]
  created_at timestamp with time zone [default: now()] [not null]
  updated_at timestamp with time zone [default: now()] [not null]

  indexes {
    unique (id) [name: 'announcement_schedules_pkey']
  }
}

Table announcement_targets {
  id uuid [default: gen_random_uuid()] [not null]
  announcement_id uuid [not null]
  target_type text [not null]
  target_id uuid
  target_name text
  created_at timestamp with time zone [default: now()] [not null]
  updated_at timestamp with time zone [default: now()] [not null]

  indexes {
    unique (id) [name: 'announcement_targets_pkey']
  }
}

Table announcement_types {
  id uuid [default: gen_random_uuid()] [not null]
  name text [not null]
  description text
  created_at timestamp with time zone [default: now()] [not null]
  updated_at timestamp with time zone [default: now()] [not null]
  organization_id uuid [not null]

  indexes {
    unique (id) [name: 'announcement_types_pkey']
  }
}

Table announcements {
  id uuid [default: gen_random_uuid()] [not null]
  title text [not null]
  content text [not null]
  property_id uuid
  communication_method _te[] [not null]
  is_scheduled boolean [default: false] [not null]
  status text [default: 'draft'] [not null]
  issue_date timestamp with time zone
  author_id uuid [not null]
  announcement_type_id uuid
  organization_id uuid [not null]
  created_at timestamp with time zone [default: now()] [not null]
  updated_at timestamp with time zone [default: now()] [not null]

  indexes {
    unique (id) [name: 'announcements_pkey']
  }
}

Table bank_account_types {
  id uuid [default: gen_random_uuid()] [not null]
  name varchar(100) [not null]
  description text
  organization_id uuid [not null]
  is_predefined boolean [default: false]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    unique (id) [name: 'bank_account_types_pkey']
  }
}

Table bank_accounts {
  id uuid [default: gen_random_uuid()] [not null]
  organization_id uuid [not null]
  account_name varchar(255) [not null]
  account_number varchar(255) [not null]
  routing_number varchar(50)
  bank_name varchar(255) [not null]
  account_type_id uuid [not null]
  last_synced timestamp with time zone
  status varchar(50) [default: 'active']
  balance_available decimal(12,2) [default: 0]
  balance_current decimal(12,2) [default: 0]
  currency varchar(10) [default: 'USD']
  created_by uuid [not null]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  is_default boolean [default: false]
  institution_id varchar(255)
  external_id varchar(255)
  metadata jsonb

  indexes {
    unique (id) [name: 'bank_accounts_pkey']
  }
}

Table communication_logs {
  id uuid [default: gen_random_uuid()] [not null]
  announcement_id uuid
  message_type text [not null]
  sender_id uuid
  recipient_type text [not null]
  recipient_id uuid [not null]
  method text [not null]
  subject text
  content text [not null]
  status text [default: 'queued'] [not null]
  error_message text
  sent_at timestamp with time zone
  delivered_at timestamp with time zone
  read_at timestamp with time zone
  organization_id uuid [not null]
  created_at timestamp with time zone [default: now()] [not null]
  updated_at timestamp with time zone [default: now()] [not null]

  indexes {
    unique (id) [name: 'communication_logs_pkey']
  }
}

Table demo_requests {
  id uuid [default: uuid_generate_v4()] [not null]
  full_name varchar(255) [not null]
  email varchar(255) [not null]
  phone varchar(50)
  company_name varchar(255) [not null]
  job_title varchar(100)
  industry varchar(100)
  company_size varchar(50)
  country varchar(100)
  demo_preferences text
  additional_comments text
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    unique (id) [name: 'demo_requests_pkey']
  }
}

Table documents {
  id uuid [default: uuid_generate_v4()] [not null]
  organization_id uuid
  document_type varchar(100) [not null]
  document_name varchar(255) [not null]
  document_url text [not null]
  related_to_type varchar(50) [not null]
  related_to_id uuid [not null]
  uploaded_by uuid
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]

  indexes {
    unique (id) [name: 'documents_pkey']
  }
}

Table expenses {
  id uuid [default: gen_random_uuid()] [not null]
  organization_id uuid [not null]
  expense_date date [not null]
  payee varchar(255) [not null]
  amount decimal(12,2) [not null]
  category_id uuid [not null]
  payment_method_id uuid
  description text
  receipt_url text
  status varchar(50) [default: 'recorded']
  property_id uuid
  unit_id uuid
  created_by uuid [not null]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    unique (id) [name: 'expenses_pkey']
    (category_id) [name: 'idx_expenses_category_id']
    (expense_date) [name: 'idx_expenses_expense_date']
    (property_id) [name: 'idx_expenses_property_id']
  }
}

Table financial_summaries {
  id uuid [default: gen_random_uuid()] [not null]
  organization_id uuid [not null]
  property_id uuid
  period_start date [not null]
  period_end date [not null]
  total_income decimal(12,2) [default: 0]
  total_expenses decimal(12,2) [default: 0]
  net_revenue decimal(12,2)
  outstanding_invoices decimal(12,2) [default: 0]
  upcoming_payables decimal(12,2) [default: 0]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    unique (organization_id, property_id, period_start, period_end) [name: 'financial_summaries_organization_id_property_id_period_star_key']
    unique (id) [name: 'financial_summaries_pkey']
  }
}

Table invoice_items {
  id uuid [default: gen_random_uuid()] [not null]
  invoice_id uuid [not null]
  description text [not null]
  quantity decimal(10,2) [default: 1] [not null]
  unit_price decimal(12,2) [not null]
  amount decimal(12,2) [not null]
  tax_rate decimal(5,2) [default: 0]
  tax_amount decimal(12,2) [default: 0]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    unique (id) [name: 'invoice_items_pkey']
  }
}

Table invoice_payments {
  id uuid [default: gen_random_uuid()] [not null]
  invoice_id uuid [not null]
  payment_id uuid [not null]
  amount_applied decimal(12,2) [not null]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    (invoice_id) [name: 'idx_invoice_payments_invoice_id']
    (payment_id) [name: 'idx_invoice_payments_payment_id']
    unique (id) [name: 'invoice_payments_pkey']
  }
}

Table invoices {
  id uuid [default: gen_random_uuid()] [not null]
  invoice_number varchar(50) [not null]
  organization_id uuid [not null]
  client_name varchar(255) [not null]
  client_id uuid
  client_type varchar(50) [not null]
  issue_date date [not null]
  due_date date [not null]
  amount_total decimal(12,2) [not null]
  amount_paid decimal(12,2) [default: 0]
  amount_due decimal(12,2)
  status varchar(50) [default: 'draft'] [not null]
  pdf_url text
  notes text
  property_id uuid
  unit_id uuid
  created_by uuid [not null]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    (client_id) [name: 'idx_invoices_client_id']
    (due_date) [name: 'idx_invoices_due_date']
    (issue_date) [name: 'idx_invoices_issue_date']
    (property_id) [name: 'idx_invoices_property_id']
    (status) [name: 'idx_invoices_status']
    unique (id) [name: 'invoices_pkey']
  }
}

Table lease_addendums {
  id uuid [default: uuid_generate_v4()] [not null]
  lease_id uuid [not null]
  title varchar(255) [not null]
  description text
  effective_date date [not null]
  document_url text
  created_by uuid
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]

  indexes {
    unique (id) [name: 'lease_addendums_pkey']
  }
}

Table lease_renewals {
  id uuid [default: uuid_generate_v4()] [not null]
  original_lease_id uuid [not null]
  new_lease_id uuid
  renewal_date date [not null]
  rent_change decimal
  renewal_term integer
  status varchar(50) [default: 'pending']
  notes text
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]

  indexes {
    unique (id) [name: 'lease_renewals_pkey']
  }
}

Table leases {
  id uuid [default: uuid_generate_v4()] [not null]
  unit_id uuid
  tenant_id uuid
  start_date date [default: now()] [not null]
  end_date date [not null]
  rent_amount decimal(12,2) [not null]
  security_deposit decimal(10,2)
  status varchar(50) [default: 'Pending']
  lease_document_url text
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]
  lease_terms text
  document_status varchar(50) [default: 'draft']
  last_payment_date date
  next_payment_date date
  current_balance decimal [default: 0]
  payment_day integer
  is_auto_renew boolean [default: false]
  notice_period_days integer [default: 30]
  late_fee_amount decimal [default: 0]
  late_fee_days integer [default: 5]

  indexes {
    unique (id) [name: 'leases_pkey']
  }
}

Table maintenance_comments {
  id uuid [default: uuid_generate_v4()] [not null]
  ticket_id uuid [not null]
  commented_by uuid
  comment text [not null]
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]

  indexes {
    unique (id) [name: 'maintenance_comments_pkey']
  }
}

Table maintenance_requests {
  id uuid [default: uuid_generate_v4()] [not null]
  unit_id uuid
  tenant_id uuid
  title varchar(255) [not null]
  description text [not null]
  priority varchar(50) [not null]
  status varchar(50) [default: 'pending']
  assigned_to uuid
  completed_at timestamp with time zone
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  due_date timestamp without time zone
  owner_id uuid
  related_to_type varchar(50)
  related_to_id uuid
  scheduled_date timestamp without time zone
  property_id uuid
  maintenance_type varchar(100)
  maintenance_type_id uuid

  indexes {
    unique (id) [name: 'maintenance_requests_pkey']
  }
}

Table maintenance_ticket_history {
  id uuid [default: uuid_generate_v4()] [not null]
  ticket_id uuid [not null]
  changed_by uuid
  change_description text [not null]
  previous_status varchar(50)
  new_status varchar(50)
  created_at timestamp without time zone [default: now()]

  indexes {
    unique (id) [name: 'maintenance_ticket_history_pkey']
  }
}

Table maintenance_types {
  id uuid [default: uuid_generate_v4()] [not null]
  organization_id uuid [not null]
  name varchar(100) [not null]
  description text
  estimated_resolution_time integer
  is_emergency boolean [default: false]
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]

  indexes {
    unique (id) [name: 'maintenance_types_pkey']
  }
}

Table notifications {
  id uuid [default: uuid_generate_v4()] [not null]
  user_id uuid
  title varchar(255) [not null]
  message text [not null]
  type varchar(50) [not null]
  read boolean [default: false]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    unique (id) [name: 'notifications_pkey']
  }
}

Table organization_invitations {
  id uuid [default: gen_random_uuid()] [not null]
  organization_id uuid [not null]
  email varchar(255) [not null]
  role_id uuid [not null]
  invited_by uuid [not null]
  token varchar(255) [not null]
  status varchar(20) [default: 'pending']
  expires_at timestamp with time zone [not null]
  created_at timestamp with time zone [default: now()]
  updated_at timestamp with time zone [default: now()]

  indexes {
    unique (organization_id, email, status) [name: 'organization_invitations_organization_id_email_status_key']
    unique (id) [name: 'organization_invitations_pkey']
    unique (token) [name: 'organization_invitations_token_key']
  }
}

Table organizations {
  id uuid [default: uuid_generate_v4()] [not null]
  name varchar(255) [not null]
  subscription_status varchar(50) [default: 'inactive']
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  subscription_plan varchar(50)
  billing_cycle varchar(20)
  billing_address text
  tax_id varchar(50)
  phone varchar(50)
  email varchar(255)
  website varchar(255)
  logo_url text
  timezone varchar(50) [default: 'UTC']
  date_format varchar(20) [default: 'YYYY-MM-DD']
  currency varchar(10) [default: 'USD']
  active boolean [default: true]

  indexes {
    unique (id) [name: 'organizations_pkey']
  }
}

Table owners {
  id uuid [default: uuid_generate_v4()] [not null]
  user_id uuid
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]
  company_name varchar(255)
  tax_id varchar(50)
  business_type varchar(50)
  email varchar(255)
  address text
  payment_method varchar(50)
  bank_account_id uuid
  taxpayer_id varchar(50)
  payment_schedule varchar(50) [default: 'monthly']
  notes text
  status varchar(50) [default: 'active']

  indexes {
    unique (id) [name: 'owners_pkey']
  }
}

Table payment_categories {
  id uuid [default: gen_random_uuid()] [not null]
  name varchar(100) [not null]
  description text
  organization_id uuid [not null]
  is_predefined boolean [default: false]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    unique (id) [name: 'payment_categories_pkey']
  }
}

Table payment_methods {
  id uuid [default: gen_random_uuid()] [not null]
  name varchar(100) [not null]
  description text
  organization_id uuid [not null]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    unique (id) [name: 'payment_methods_pkey']
  }
}

Table payment_schedules {
  id uuid [default: gen_random_uuid()] [not null]
  organization_id uuid [not null]
  lease_id uuid
  bank_account_id uuid [not null]
  amount decimal(10,2) [not null]
  frequency varchar(50) [not null]
  start_date date [not null]
  end_date date
  next_schedule_date date [not null]
  last_run_date date
  day_of_month integer
  active boolean [default: true]
  description text
  category_id uuid
  created_by uuid [not null]
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    unique (id) [name: 'payment_schedules_pkey']
  }
}

Table payment_transactions {
  id uuid [default: gen_random_uuid()] [not null]
  organization_id uuid [not null]
  payment_id uuid [not null]
  transaction_date timestamp with time zone [default: CURRENT_TIMESTAMP]
  amount decimal(10,2) [not null]
  status varchar(50) [default: 'pending']
  external_id varchar(255)
  gateway_response jsonb
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]

  indexes {
    unique (id) [name: 'payment_transactions_pkey']
  }
}

Table payments {
  id uuid [default: uuid_generate_v4()] [not null]
  lease_id uuid
  amount decimal(12,2) [not null]
  payment_date date [not null]
  status varchar(50) [default: 'pending']
  transaction_id varchar(255)
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  payment_type varchar(50) [default: 'one-time']
  category_id uuid
  bank_account_id uuid
  organization_id uuid [not null]
  payment_method_id uuid
  next_scheduled_date date
  created_by uuid
  recipient_type varchar(50)
  recipient_id uuid
  invoice_id uuid

  indexes {
    (bank_account_id) [name: 'idx_payments_bank_account_id']
    (category_id) [name: 'idx_payments_category_id']
    (lease_id) [name: 'idx_payments_lease_id']
    (payment_date) [name: 'idx_payments_payment_date']
    (payment_type) [name: 'idx_payments_payment_type']
    (status) [name: 'idx_payments_status']
    unique (id) [name: 'payments_pkey']
  }
}

Table properties {
  id uuid [default: uuid_generate_v4()] [not null]
  name varchar(255) [not null]
  address text [not null]
  city varchar(100) [not null]
  state varchar(100) [not null]
  zip_code varchar(20) [not null]
  total_units integer [not null]
  owner_id uuid
  organization_id uuid
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]
  monthly_revenue decimal [default: 0]
  occupancy_rate decimal [default: 0]
  active_leases integer [default: 0]
  property_manager_id uuid
  last_activity_date timestamp with time zone
  property_status varchar(50) [default: 'active']

  indexes {
    unique (id) [name: 'properties_pkey']
  }
}

Table property_inspections {
  id uuid [default: gen_random_uuid()] [not null]
  property_id uuid
  unit_id uuid
  inspection_date timestamp with time zone [not null]
  inspector_id uuid
  status text [default: 'scheduled'] [not null]
  notes text
  report_url text
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  organization_id uuid [not null]

  indexes {
    unique (id) [name: 'property_inspections_pkey']
  }
}

Table property_managers {
  id uuid [default: uuid_generate_v4()] [not null]
  user_id uuid
  organization_id uuid
  assigned_properties _uu[] [default: '{}']
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]

  indexes {
    unique (id) [name: 'property_managers_pkey']
  }
}

Table property_metrics {
  id uuid [default: gen_random_uuid()] [not null]
  property_id uuid [not null]
  metric_date date [not null]
  monthly_revenue decimal [default: 0]
  occupancy_rate decimal [default: 0]
  active_leases integer [default: 0]
  maintenance_costs decimal [default: 0]
  operational_costs decimal [default: 0]
  collected_rent decimal [default: 0]
  outstanding_rent decimal [default: 0]
  created_at timestamp with time zone [default: now()]
  total_income decimal(12,2) [default: 0]
  total_expenses decimal(12,2) [default: 0]
  net_revenue decimal(12,2)
  outstanding_invoices decimal(12,2) [default: 0]

  indexes {
    unique (id) [name: 'property_metrics_pkey']
    unique (property_id, metric_date) [name: 'property_metrics_property_id_metric_date_key']
  }
}

Table property_stakeholders {
  id uuid [default: gen_random_uuid()] [not null]
  property_id uuid [not null]
  user_id uuid [not null]
  stakeholder_type varchar(50) [not null]
  ownership_percentage decimal [default: 100]
  is_primary boolean [default: false]
  start_date date [not null]
  end_date date
  notes text
  created_at timestamp with time zone [default: now()]
  updated_at timestamp with time zone [default: now()]

  indexes {
    unique (id) [name: 'property_stakeholders_pkey']
    unique (property_id, user_id, stakeholder_type) [name: 'property_stakeholders_property_id_user_id_stakeholder_type_key']
  }
}

Table rental_applications {
  id uuid [default: gen_random_uuid()] [not null]
  property_id uuid
  unit_id uuid
  applicant_id uuid
  application_date timestamp with time zone [default: now()]
  desired_move_in_date date
  lease_term integer
  status varchar(50) [default: 'pending']
  monthly_income decimal
  has_pets boolean [default: false]
  pet_details jsonb
  has_vehicles boolean [default: false]
  vehicle_details jsonb
  employment_info jsonb
  previous_address text
  emergency_contact jsonb
  application_fee_paid boolean [default: false]
  background_check_status varchar(50)
  credit_check_status varchar(50)
  rejection_reason text
  notes text
  reviewed_by uuid
  review_date timestamp with time zone
  created_at timestamp with time zone [default: now()]
  updated_at timestamp with time zone [default: now()]

  indexes {
    unique (id) [name: 'rental_applications_pkey']
  }
}

Table roles {
  id uuid [default: uuid_generate_v4()] [not null]
  name varchar(50) [not null]
  description text
  is_system_role boolean [default: false]
  permissions jsonb
  updated_at timestamp with time zone [default: now()]

  indexes {
    unique (name) [name: 'roles_name_key']
    unique (id) [name: 'roles_pkey']
  }
}

Table tasks {
  id uuid [default: uuid_generate_v4()] [not null]
  organization_id uuid
  title varchar(255) [not null]
  description text
  priority varchar(50) [not null]
  status varchar(50) [default: 'pending'] [not null]
  due_date timestamp without time zone
  owner_id uuid
  assigned_to uuid
  related_to_type varchar(50)
  related_to_id uuid
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]

  indexes {
    unique (id) [name: 'tasks_pkey']
  }
}

Table team_members {
  id uuid [default: gen_random_uuid()] [not null]
  user_id uuid [not null]
  role_id uuid
  job_title varchar(100)
  department varchar(100)
  created_at timestamp with time zone [default: now()]
  updated_at timestamp with time zone [default: now()]

  indexes {
    unique (id) [name: 'team_members_pkey']
  }
}

Table tenants {
  id uuid [default: uuid_generate_v4()] [not null]
  user_id uuid
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]
  move_in_date date
  lease_end_date date
  current_property_id uuid
  current_unit_id uuid
  rent_amount decimal
  status varchar(50) [default: 'active']
  emergency_contact_phone varchar(50)
  emergency_contact_relationship varchar(100)
  preferred_contact_methods _te[] [default: ARRAY['email']
  language_preference varchar(50) [default: 'English']
  payment_history jsonb
  backgroundcheckdate date
  background_check_passed boolean
  pets jsonb
  vehicles jsonb
  eviction_history boolean [default: false]
  special_accommodations text
  lease_start_date date [not null]
  emergency_contact jsonb
  background_check_status varchar(50) [default: 'pending']
  background_check_date date

  indexes {
    unique (id) [name: 'tenants_pkey']
  }
}

Table units {
  id uuid [default: uuid_generate_v4()] [not null]
  property_id uuid
  unit_number varchar(50) [not null]
  floor_plan varchar(100)
  square_feet integer
  bedrooms integer
  bathrooms decimal(2,1)
  rent_amount decimal(10,2)
  status varchar(50) [default: 'Available']
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]
  current_tenant_id uuid
  lease_start_date date
  lease_end_date date
  last_inspection_date date
  next_inspection_date date
  smart_lock_enabled boolean [default: false]
  smart_lock_details jsonb
  utility_meters jsonb
  maintenance_history jsonb

  indexes {
    unique (id) [name: 'units_pkey']
    unique (property_id, unit_number) [name: 'units_property_id_unit_number_key']
  }
}

Table user_profiles {
  id uuid [not null]
  email varchar(255) [not null]
  first_name varchar(100) [not null]
  last_name varchar(100) [not null]
  organization_id uuid
  phone varchar(50)
  created_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  updated_at timestamp with time zone [default: CURRENT_TIMESTAMP]
  profile_image_url text
  default_organization_id uuid
  status varchar(20) [default: 'active']
  last_login_at timestamp with time zone
  email_verified boolean [default: false]
  phone_verified boolean [default: false]
  two_factor_enabled boolean [default: false]
  notification_preferences jsonb
  verification_status varchar(20) [default: 'unverified']
  time_zone varchar(50) [default: 'UTC']
  preferred_contact_methods _te[] [default: ARRAY['email']
  preferred_contact_time varchar(50)

  indexes {
    unique (email) [name: 'user_profiles_email_key']
    unique (id) [name: 'user_profiles_pkey']
  }
}

Table user_roles {
  id uuid [default: uuid_generate_v4()] [not null]
  user_id uuid
  role_id uuid
  organization_id uuid
  created_at timestamp with time zone [default: now()]
  updated_at timestamp with time zone [default: now()]

  indexes {
    unique (user_id, role_id, organization_id) [name: 'unique_user_role_organization']
    unique (id) [name: 'user_roles_pkey']
    unique (user_id, role_id, organization_id) [name: 'user_roles_user_id_role_id_organization_id_key']
  }
}

Table vendors {
  id uuid [default: uuid_generate_v4()] [not null]
  user_id uuid
  service_type varchar(100) [not null]
  hourly_rate decimal
  notes text
  created_at timestamp without time zone [default: now()]
  updated_at timestamp without time zone [default: now()]
  business_type varchar(50)
  service_areas jsonb
  service_availability jsonb
  emergency_service boolean [default: false]
  payment_terms varchar(100)
  preferred_bank_account_id uuid
  performance_rating decimal(3,2)

  indexes {
    unique (id) [name: 'vendors_pkey']
  }
}


// Relationships
Ref: organization_invitations.invited_by > user_profiles.id
Ref: organization_invitations.organization_id > organizations.id
Ref: organization_invitations.role_id > roles.id
Ref: expenses.category_id > payment_categories.id
Ref: expenses.created_by > user_profiles.id
Ref: expenses.organization_id > organizations.id
Ref: expenses.payment_method_id > payment_methods.id
Ref: expenses.property_id > properties.id
Ref: financial_summaries.organization_id > organizations.id
Ref: financial_summaries.property_id > properties.id
Ref: invoice_payments.invoice_id > invoices.id
Ref: invoice_payments.payment_id > payments.id
Ref: property_stakeholders.property_id > properties.id
Ref: property_stakeholders.user_id > user_profiles.id
Ref: rental_applications.applicant_id > user_profiles.id
Ref: rental_applications.property_id > properties.id
Ref: rental_applications.reviewed_by > user_profiles.id
Ref: rental_applications.unit_id > units.id
Ref: activity_logs.organization_id > organizations.id
Ref: activity_logs.property_id > properties.id
Ref: activity_logs.unit_id > units.id
Ref: activity_logs.user_id > user_profiles.id
Ref: property_metrics.property_id > properties.id
Ref: property_managers.organization_id > organizations.id
Ref: property_managers.user_id > user_profiles.id
Ref: leases.tenant_id > tenants.id
Ref: leases.unit_id > units.id
Ref: properties.organization_id > organizations.id
Ref: properties.owner_id > owners.id
Ref: properties.property_manager_id > property_managers.id
Ref: tasks.assigned_to > user_profiles.id
Ref: tasks.organization_id > organizations.id
Ref: tasks.owner_id > user_profiles.id
Ref: units.current_tenant_id > user_profiles.id
Ref: units.property_id > properties.id
Ref: documents.organization_id > organizations.id
Ref: documents.uploaded_by > user_profiles.id
Ref: user_roles.organization_id > organizations.id
Ref: user_roles.role_id > roles.id
Ref: user_roles.user_id > user_profiles.id
Ref: lease_addendums.created_by > user_profiles.id
Ref: lease_addendums.lease_id > leases.id
Ref: lease_renewals.new_lease_id > leases.id
Ref: lease_renewals.original_lease_id > leases.id
Ref: property_inspections.inspector_id > user_profiles.id
Ref: property_inspections.organization_id > organizations.id
Ref: property_inspections.property_id > properties.id
Ref: property_inspections.unit_id > units.id
Ref: maintenance_types.organization_id > organizations.id
Ref: maintenance_requests.assigned_to > user_profiles.id
Ref: maintenance_requests.maintenance_type_id > maintenance_types.id
Ref: maintenance_requests.owner_id > user_profiles.id
Ref: maintenance_requests.property_id > properties.id
Ref: maintenance_requests.tenant_id > user_profiles.id
Ref: maintenance_ticket_history.changed_by > user_profiles.id
Ref: maintenance_ticket_history.ticket_id > maintenance_requests.id
Ref: maintenance_comments.commented_by > user_profiles.id
Ref: maintenance_comments.ticket_id > maintenance_requests.id
Ref: payments.bank_account_id > bank_accounts.id
Ref: payments.category_id > payment_categories.id
Ref: payments.created_by > user_profiles.id
Ref: payments.invoice_id > invoices.id
Ref: payments.lease_id > leases.id
Ref: payments.organization_id > organizations.id
Ref: payments.payment_method_id > payment_methods.id
Ref: announcement_types.organization_id > organizations.id
Ref: announcements.announcement_type_id > announcement_types.id
Ref: announcements.organization_id > organizations.id
Ref: announcements.property_id > properties.id
Ref: announcement_targets.announcement_id > announcements.id
Ref: announcement_schedules.announcement_id > announcements.id
Ref: user_profiles.default_organization_id > organizations.id
Ref: user_profiles.organization_id > organizations.id
Ref: notifications.user_id > user_profiles.id
Ref: communication_logs.announcement_id > announcements.id
Ref: communication_logs.organization_id > organizations.id
Ref: bank_account_types.organization_id > organizations.id
Ref: owners.bank_account_id > bank_accounts.id
Ref: owners.user_id > user_profiles.id
Ref: bank_accounts.account_type_id > bank_account_types.id
Ref: bank_accounts.created_by > user_profiles.id
Ref: bank_accounts.organization_id > organizations.id
Ref: vendors.preferred_bank_account_id > bank_accounts.id
Ref: vendors.user_id > user_profiles.id
Ref: payment_categories.organization_id > organizations.id
Ref: payment_methods.organization_id > organizations.id
Ref: tenants.current_property_id > properties.id
Ref: tenants.current_unit_id > units.id
Ref: tenants.user_id > user_profiles.id
Ref: payment_schedules.bank_account_id > bank_accounts.id
Ref: payment_schedules.category_id > payment_categories.id
Ref: payment_schedules.created_by > user_profiles.id
Ref: payment_schedules.lease_id > leases.id
Ref: payment_schedules.organization_id > organizations.id
Ref: payment_transactions.organization_id > organizations.id
Ref: payment_transactions.payment_id > payments.id
Ref: team_members.role_id > roles.id
Ref: team_members.user_id > user_profiles.id
Ref: invoices.created_by > user_profiles.id
Ref: invoices.organization_id > organizations.id
Ref: invoices.property_id > properties.id
Ref: invoices.unit_id > units.id
Ref: invoice_items.invoice_id > invoices.id
