-- Updated Supabase Database Schema
-- Last updated: Sun Apr  6 12:22:44 AM +03 2025

-- Enable UUID extension
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

CREATE TABLE activity_logs (  "property_id" uuid,\n  "organization_id" uuid NOT NULL,\n  "activity_type" character varying(100) NOT NULL,\n  "created_at" timestamp with time zone DEFAULT now(),\n  "metadata" jsonb,\n  "user_id" uuid,\n  "unit_id" uuid,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "description" text NOT NULL\n);
CREATE TABLE announcement_background_tasks (  "job_id" uuid NOT NULL,\n  "status" text NOT NULL DEFAULT 'pending'::text,\n  "announcement_id" uuid NOT NULL,\n  "remaining_count" integer(32,0) NOT NULL DEFAULT 0,\n  "next_batch_index" integer(32,0) NOT NULL DEFAULT 0,\n  "created_at" timestamp with time zone NOT NULL DEFAULT now(),\n  "completed_at" timestamp with time zone,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "error_message" text\n);
CREATE TABLE announcement_jobs (  "updated_at" timestamp with time zone NOT NULL DEFAULT now(),\n  "error_message" text,\n  "status" text NOT NULL DEFAULT 'pending'::text,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "announcement_id" uuid NOT NULL,\n  "total_tenants" integer(32,0) NOT NULL DEFAULT 0,\n  "processed_count" integer(32,0) NOT NULL DEFAULT 0,\n  "success_count" integer(32,0) NOT NULL DEFAULT 0,\n  "failure_count" integer(32,0) NOT NULL DEFAULT 0,\n  "started_at" timestamp with time zone,\n  "completed_at" timestamp with time zone,\n  "last_processed_id" uuid,\n  "created_at" timestamp with time zone NOT NULL DEFAULT now()\n);
CREATE TABLE announcement_schedules (  "repeat_frequency" text,\n  "end_date" timestamp with time zone,\n  "repeat_on" jsonb,\n  "time_of_day" time without time zone NOT NULL,\n  "announcement_id" uuid NOT NULL,\n  "start_date" timestamp with time zone NOT NULL,\n  "next_run" timestamp with time zone,\n  "updated_at" timestamp with time zone NOT NULL DEFAULT now(),\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "created_at" timestamp with time zone NOT NULL DEFAULT now()\n);
CREATE TABLE announcement_targets (  "created_at" timestamp with time zone NOT NULL DEFAULT now(),\n  "property_id" uuid NOT NULL,\n  "target_name" text,\n  "target_type" text NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "announcement_id" uuid NOT NULL,\n  "target_id" uuid,\n  "updated_at" timestamp with time zone NOT NULL DEFAULT now()\n);
CREATE TABLE announcement_types (  "updated_at" timestamp with time zone NOT NULL DEFAULT now(),\n  "name" text NOT NULL,\n  "description" text,\n  "organization_id" uuid NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "created_at" timestamp with time zone NOT NULL DEFAULT now()\n);
CREATE TABLE announcements (  "issue_date" timestamp with time zone,\n  "is_scheduled" boolean NOT NULL DEFAULT false,\n  "type" text NOT NULL,\n  "status" text NOT NULL DEFAULT 'draft'::text,\n  "updated_at" timestamp with time zone NOT NULL DEFAULT now(),\n  "created_at" timestamp with time zone NOT NULL DEFAULT now(),\n  "organization_id" uuid NOT NULL,\n  "author_id" uuid NOT NULL,\n  "title" text NOT NULL,\n  "content" text NOT NULL,\n  "communication_method" ARRAY NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid()\n);
CREATE TABLE bank_account_types (  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "name" character varying(100) NOT NULL,\n  "description" text,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "organization_id" uuid NOT NULL,\n  "is_predefined" boolean DEFAULT false,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP\n);
CREATE TABLE bank_accounts (  "routing_number" character varying(50),\n  "external_id" character varying(255),\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "organization_id" uuid NOT NULL,\n  "account_type_id" uuid NOT NULL,\n  "last_synced" timestamp with time zone,\n  "balance_available" numeric(12,2) DEFAULT 0,\n  "balance_current" numeric(12,2) DEFAULT 0,\n  "created_by" uuid NOT NULL,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "is_default" boolean DEFAULT false,\n  "metadata" jsonb,\n  "institution_id" character varying(255),\n  "currency" character varying(10) DEFAULT 'USD'::character varying,\n  "status" character varying(50) DEFAULT 'active'::character varying,\n  "account_number" character varying(255) NOT NULL,\n  "bank_name" character varying(255) NOT NULL,\n  "account_name" character varying(255) NOT NULL\n);
CREATE TABLE communication_logs (  "updated_at" timestamp with time zone NOT NULL DEFAULT now(),\n  "created_at" timestamp with time zone NOT NULL DEFAULT now(),\n  "organization_id" uuid NOT NULL,\n  "read_at" timestamp with time zone,\n  "delivered_at" timestamp with time zone,\n  "sent_at" timestamp with time zone,\n  "recipient_id" uuid NOT NULL,\n  "sender_id" uuid,\n  "announcement_id" uuid,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "message_type" text NOT NULL,\n  "error_message" text,\n  "status" text NOT NULL DEFAULT 'queued'::text,\n  "method" text NOT NULL,\n  "content" text NOT NULL,\n  "subject" text,\n  "recipient_type" text NOT NULL\n);
CREATE TABLE demo_requests (  "demo_preferences" text,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "full_name" character varying(255) NOT NULL,\n  "email" character varying(255) NOT NULL,\n  "phone" character varying(50),\n  "company_name" character varying(255) NOT NULL,\n  "job_title" character varying(100),\n  "industry" character varying(100),\n  "company_size" character varying(50),\n  "country" character varying(100),\n  "additional_comments" text,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP\n);
CREATE TABLE departments (  "created_at" timestamp with time zone DEFAULT now(),\n  "role_id" uuid,\n  "name" character varying(100) NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "organization_id" uuid NOT NULL,\n  "updated_at" timestamp with time zone DEFAULT now()\n);
CREATE TABLE documents (  "document_name" character varying(255) NOT NULL,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "organization_id" uuid,\n  "document_url" text NOT NULL,\n  "related_to_type" character varying(50) NOT NULL,\n  "created_at" timestamp without time zone DEFAULT now(),\n  "uploaded_by" uuid,\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "related_to_id" uuid NOT NULL,\n  "document_type" character varying(100) NOT NULL\n);
CREATE TABLE expenses (  "unit_id" uuid,\n  "receipt_url" text,\n  "property_id" uuid,\n  "payment_method_id" uuid,\n  "category_id" uuid NOT NULL,\n  "organization_id" uuid NOT NULL,\n  "description" text,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "amount" numeric(12,2) NOT NULL,\n  "payee" character varying(255) NOT NULL,\n  "status" character varying(50) DEFAULT 'recorded'::character varying,\n  "expense_date" date NOT NULL,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "created_by" uuid NOT NULL\n);
CREATE TABLE financial_summaries (  "property_id" uuid,\n  "total_expenses" numeric(12,2) DEFAULT 0,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "total_income" numeric(12,2) DEFAULT 0,\n  "period_end" date NOT NULL,\n  "period_start" date NOT NULL,\n  "net_revenue" numeric(12,2),\n  "organization_id" uuid NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "outstanding_invoices" numeric(12,2) DEFAULT 0,\n  "upcoming_payables" numeric(12,2) DEFAULT 0\n);
CREATE TABLE invoice_items (  "description" text NOT NULL,\n  "amount" numeric(12,2) NOT NULL,\n  "unit_price" numeric(12,2) NOT NULL,\n  "invoice_id" uuid NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "quantity" numeric(10,2) NOT NULL DEFAULT 1,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "tax_amount" numeric(12,2) DEFAULT 0,\n  "tax_rate" numeric(5,2) DEFAULT 0\n);
CREATE TABLE invoice_payments (  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "amount_applied" numeric(12,2) NOT NULL,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "payment_id" uuid NOT NULL,\n  "invoice_id" uuid NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid()\n);
CREATE TABLE invoices (  "due_date" date NOT NULL,\n  "notes" text,\n  "client_name" character varying(255) NOT NULL,\n  "pdf_url" text,\n  "invoice_number" character varying(50) NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "organization_id" uuid NOT NULL,\n  "client_id" uuid,\n  "issue_date" date NOT NULL,\n  "amount_total" numeric(12,2) NOT NULL,\n  "amount_paid" numeric(12,2) DEFAULT 0,\n  "amount_due" numeric(12,2),\n  "property_id" uuid,\n  "unit_id" uuid,\n  "created_by" uuid NOT NULL,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "status" character varying(50) NOT NULL DEFAULT 'draft'::character varying,\n  "client_type" character varying(50) NOT NULL\n);
CREATE TABLE lease_addendums (  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "created_at" timestamp without time zone DEFAULT now(),\n  "created_by" uuid,\n  "effective_date" date NOT NULL,\n  "lease_id" uuid NOT NULL,\n  "document_url" text,\n  "description" text,\n  "title" character varying(255) NOT NULL,\n  "updated_at" timestamp without time zone DEFAULT now()\n);
CREATE TABLE lease_charges (  "lease_id" uuid NOT NULL,\n  "is_recurring" boolean DEFAULT false,\n  "period_start_date" date,\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "created_at" timestamp without time zone DEFAULT now(),\n  "amount" numeric(12,2) NOT NULL,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "description" text NOT NULL,\n  "type" character varying(50) NOT NULL,\n  "charge_status" character varying(50) NOT NULL DEFAULT 'pending'::character varying\n);
CREATE TABLE lease_documents (  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "created_at" timestamp without time zone NOT NULL DEFAULT now(),\n  "document_url" text NOT NULL,\n  "updated_at" timestamp without time zone NOT NULL DEFAULT now(),\n  "document_status" character varying(50) NOT NULL DEFAULT 'Not Signed'::character varying,\n  "lease_id" uuid NOT NULL\n);
CREATE TABLE lease_period_payments (  "due_date" date,\n  "status" text DEFAULT 'pending'::text,\n  "period_start_date" date,\n  "lease_id" uuid,\n  "id" bigint(64,0) NOT NULL,\n  "total_amount" numeric(10,2)\n);
CREATE TABLE lease_renewals (  "created_at" timestamp without time zone DEFAULT now(),\n  "rent_change" numeric,\n  "renewal_date" date NOT NULL,\n  "renewal_term" integer(32,0),\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "original_lease_id" uuid NOT NULL,\n  "new_lease_id" uuid,\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "notes" text,\n  "status" character varying(50) DEFAULT 'pending'::character varying\n);
CREATE TABLE leases (  "start_date" date NOT NULL DEFAULT now(),\n  "end_date" date,\n  "rent_amount" numeric(12,2) NOT NULL,\n  "security_deposit_status" character varying(50) NOT NULL DEFAULT 'pending'::character varying,\n  "rent_payment_status" character varying(50) NOT NULL DEFAULT 'pending'::character varying,\n  "lease_issuer_id" uuid NOT NULL,\n  "payment_frequency" text NOT NULL DEFAULT 'Monthly'::text,\n  "security_deposit" numeric(10,2),\n  "created_at" timestamp without time zone DEFAULT now(),\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "last_payment_date" date,\n  "next_payment_date" date,\n  "is_auto_renew" boolean DEFAULT false,\n  "notice_period_days" integer(32,0) DEFAULT 30,\n  "late_fee_amount" numeric DEFAULT 0,\n  "payment_status" character varying(50) NOT NULL DEFAULT 'pending'::character varying,\n  "late_fee_days" integer(32,0) DEFAULT 5,\n  "roll_over_to_month_to_month" boolean NOT NULL DEFAULT false,\n  "organization_id" uuid,\n  "payment_date" integer(32,0),\n  "unit_id" uuid NOT NULL,\n  "status" character varying(50) DEFAULT 'Pending'::character varying,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "tenant_id" uuid NOT NULL,\n  "lease_terms" text,\n  "document_status" character varying(50) DEFAULT 'Not signed'::character varying\n);
CREATE TABLE maintenance_comments (  "updated_at" timestamp without time zone DEFAULT now(),\n  "comment" text NOT NULL,\n  "created_at" timestamp without time zone DEFAULT now(),\n  "commented_by" uuid,\n  "ticket_id" uuid NOT NULL,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4()\n);
CREATE TABLE maintenance_requests (  "assigned_to" uuid,\n  "related_to_type" character varying(50),\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "unit_id" uuid,\n  "tenant_id" uuid,\n  "title" character varying(255) NOT NULL,\n  "completed_at" timestamp with time zone,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "due_date" timestamp without time zone,\n  "owner_id" uuid,\n  "maintenance_type" character varying(100),\n  "related_to_id" uuid,\n  "scheduled_date" timestamp without time zone,\n  "property_id" uuid,\n  "maintenance_type_id" uuid,\n  "description" text NOT NULL,\n  "status" character varying(50) DEFAULT 'pending'::character varying,\n  "priority" character varying(50) NOT NULL\n);
CREATE TABLE maintenance_ticket_history (  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "previous_status" character varying(50),\n  "new_status" character varying(50),\n  "change_description" text NOT NULL,\n  "created_at" timestamp without time zone DEFAULT now(),\n  "changed_by" uuid,\n  "ticket_id" uuid NOT NULL\n);
CREATE TABLE maintenance_types (  "description" text,\n  "created_at" timestamp without time zone DEFAULT now(),\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "organization_id" uuid NOT NULL,\n  "estimated_resolution_time" integer(32,0),\n  "name" character varying(100) NOT NULL,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "is_emergency" boolean DEFAULT false\n);
CREATE TABLE notifications (  "user_id" uuid,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "title" character varying(255) NOT NULL,\n  "message" text NOT NULL,\n  "related_type" character varying(50) NOT NULL,\n  "is_read" boolean DEFAULT false\n);
CREATE TABLE organization_invitations (  "role_id" uuid NOT NULL,\n  "status" character varying(20) DEFAULT 'pending'::character varying,\n  "token" character varying(255),\n  "email" character varying(255) NOT NULL,\n  "updated_at" timestamp with time zone DEFAULT now(),\n  "created_at" timestamp with time zone DEFAULT now(),\n  "expires_at" timestamp with time zone NOT NULL,\n  "invited_by" uuid NOT NULL,\n  "organization_id" uuid NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid()\n);
CREATE TABLE organizations (  "billing_cycle" character varying(20),\n  "subscription_status" character varying(50) DEFAULT 'inactive'::character varying,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "website" character varying(255),\n  "billing_address" text,\n  "subscription_plan" character varying(50),\n  "tax_id" character varying(50),\n  "logo_url" text,\n  "currency" character varying(10) DEFAULT 'USD'::character varying,\n  "timezone" character varying(50) DEFAULT 'UTC'::character varying,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "active" boolean DEFAULT true,\n  "date_format" character varying(20) DEFAULT 'YYYY-MM-DD'::character varying,\n  "phone" character varying(50),\n  "email" character varying(255),\n  "name" character varying(255) NOT NULL\n);
CREATE TABLE owner_properties (  "owner_id" uuid NOT NULL,\n  "property_id" uuid NOT NULL,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP\n);
CREATE TABLE owners (  "created_at" timestamp without time zone DEFAULT now(),\n  "status" character varying(50) DEFAULT 'active'::character varying,\n  "notes" text,\n  "payment_schedule" character varying(50) DEFAULT 'monthly'::character varying,\n  "taxpayer_id" character varying(50),\n  "first_name" character varying(100),\n  "payment_method" character varying(50),\n  "address" text,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "user_id" uuid,\n  "last_name" character varying(100),\n  "phone" character varying(50),\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "bank_account_id" uuid,\n  "organization_id" uuid NOT NULL,\n  "email" character varying(255),\n  "owner_type" character varying(50),\n  "company_name" character varying(255),\n  "tax_id" character varying(50)\n);
CREATE TABLE payment_categories (  "organization_id" uuid NOT NULL,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "name" character varying(100) NOT NULL,\n  "is_predefined" boolean DEFAULT false,\n  "description" text,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid()\n);
CREATE TABLE payment_methods (  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "organization_id" uuid NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "name" character varying(100) NOT NULL,\n  "description" text,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP\n);
CREATE TABLE payment_schedules (  "day_of_month" integer(32,0),\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "organization_id" uuid NOT NULL,\n  "lease_id" uuid,\n  "bank_account_id" uuid NOT NULL,\n  "amount" numeric(10,2) NOT NULL,\n  "start_date" date NOT NULL,\n  "end_date" date,\n  "next_schedule_date" date NOT NULL,\n  "last_run_date" date,\n  "active" boolean DEFAULT true,\n  "category_id" uuid,\n  "created_by" uuid NOT NULL,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "frequency" character varying(50) NOT NULL,\n  "description" text\n);
CREATE TABLE payment_transactions (  "payment_id" uuid NOT NULL,\n  "transaction_date" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "amount" numeric(10,2) NOT NULL,\n  "gateway_response" jsonb,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "external_id" character varying(255),\n  "status" character varying(50) DEFAULT 'pending'::character varying,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "organization_id" uuid NOT NULL\n);
CREATE TABLE payments (  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "lease_id" uuid,\n  "amount" numeric(12,2) NOT NULL,\n  "payment_date" date NOT NULL,\n  "recipient_type" character varying(50),\n  "created_by" uuid,\n  "next_scheduled_date" date,\n  "recipient_id" uuid,\n  "payment_type" character varying(50) DEFAULT 'one-time'::character varying,\n  "status" character varying(50) DEFAULT 'pending'::character varying,\n  "transaction_id" character varying(255),\n  "payment_method_id" uuid,\n  "organization_id" uuid NOT NULL,\n  "bank_account_id" uuid,\n  "category_id" uuid,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "is_offline" boolean DEFAULT false,\n  "invoice_id" uuid\n);
CREATE TABLE properties (  "organization_id" uuid NOT NULL,\n  "property_type" character varying(50) NOT NULL DEFAULT 'residential'::character varying,\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "last_activity_date" timestamp with time zone,\n  "active_leases" integer(32,0) DEFAULT 0,\n  "created_at" timestamp without time zone DEFAULT now(),\n  "occupancy_rate" numeric DEFAULT 0,\n  "monthly_revenue" numeric DEFAULT 0,\n  "status" character varying(50) DEFAULT 'active'::character varying,\n  "owner_id" uuid,\n  "total_units" integer(32,0) NOT NULL,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "zip_code" character varying(20) NOT NULL,\n  "state" character varying(100) NOT NULL,\n  "city" character varying(100) NOT NULL,\n  "address" text NOT NULL,\n  "name" character varying(255) NOT NULL\n);
CREATE TABLE property_images (  "property_id" uuid NOT NULL,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "image_url" text NOT NULL,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4()\n);
CREATE TABLE property_inspections (  "organization_id" uuid NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "property_id" uuid,\n  "unit_id" uuid,\n  "inspection_date" timestamp with time zone NOT NULL,\n  "inspector_id" uuid,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "report_url" text,\n  "notes" text,\n  "status" text NOT NULL DEFAULT 'scheduled'::text\n);
CREATE TABLE property_managers (  "user_id" uuid,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "organization_id" uuid,\n  "created_at" timestamp without time zone DEFAULT now(),\n  "assigned_properties" ARRAY DEFAULT '{}'::uuid[],\n  "updated_at" timestamp without time zone DEFAULT now()\n);
CREATE TABLE property_metrics (  "net_revenue" numeric(12,2),\n  "total_expenses" numeric(12,2) DEFAULT 0,\n  "total_income" numeric(12,2) DEFAULT 0,\n  "created_at" timestamp with time zone DEFAULT now(),\n  "outstanding_rent" numeric DEFAULT 0,\n  "collected_rent" numeric DEFAULT 0,\n  "operational_costs" numeric DEFAULT 0,\n  "maintenance_costs" numeric DEFAULT 0,\n  "occupancy_rate" numeric DEFAULT 0,\n  "active_leases" integer(32,0) DEFAULT 0,\n  "monthly_revenue" numeric DEFAULT 0,\n  "metric_date" date NOT NULL,\n  "property_id" uuid NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "outstanding_invoices" numeric(12,2) DEFAULT 0\n);
CREATE TABLE property_stakeholders (  "user_id" uuid NOT NULL,\n  "start_date" date NOT NULL,\n  "updated_at" timestamp with time zone DEFAULT now(),\n  "created_at" timestamp with time zone DEFAULT now(),\n  "stakeholder_type" character varying(50) NOT NULL,\n  "ownership_percentage" numeric DEFAULT 100,\n  "is_primary" boolean DEFAULT false,\n  "end_date" date,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "property_id" uuid NOT NULL,\n  "notes" text\n);
CREATE TABLE rental_application_documents (  "file_type" text NOT NULL,\n  "uploaded_by" uuid NOT NULL,\n  "uploaded_at" timestamp with time zone DEFAULT now(),\n  "rental_application_id" uuid NOT NULL,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "file_name" text NOT NULL,\n  "file_path" text NOT NULL\n);
CREATE TABLE rental_applications (  "updated_at" timestamp with time zone DEFAULT now(),\n  "employment_info" jsonb,\n  "emergency_contact" jsonb,\n  "background_check_status" character varying(50),\n  "previous_address" text,\n  "application_fee_paid" boolean DEFAULT false,\n  "has_vehicles" boolean DEFAULT false,\n  "id_type" character varying(50),\n  "reviewed_by" uuid,\n  "pet_details" jsonb,\n  "review_date" timestamp with time zone,\n  "created_at" timestamp with time zone DEFAULT now(),\n  "vehicle_details" jsonb,\n  "has_pets" boolean DEFAULT false,\n  "applicant_name" character varying(255) NOT NULL,\n  "notes" text,\n  "applicant_email" character varying(255),\n  "rejection_reason" text,\n  "applicant_id" bigint(64,0) NOT NULL,\n  "credit_check_status" character varying(50),\n  "monthly_income" numeric,\n  "lease_term" integer(32,0),\n  "desired_move_in_date" date,\n  "applicant_phone_number" character varying(20),\n  "status" character varying(50) DEFAULT 'pending'::character varying,\n  "application_date" timestamp with time zone DEFAULT now(),\n  "unit_id" uuid,\n  "property_id" uuid,\n  "preferred_contact_method" ARRAY,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "organization_id" uuid NOT NULL,\n  "is_employed" boolean NOT NULL DEFAULT false,\n  "expiry_date" date\n);
CREATE TABLE roles (  "updated_at" timestamp with time zone DEFAULT now(),\n  "is_system_role" boolean DEFAULT false,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "name" character varying(50) NOT NULL,\n  "description" text,\n  "permissions" jsonb\n);
CREATE TABLE task_assignees (  "user_id" uuid NOT NULL,\n  "task_id" uuid NOT NULL,\n  "assigned_at" timestamp without time zone DEFAULT now()\n);
CREATE TABLE tasks (  "created_at" timestamp without time zone DEFAULT now(),\n  "priority" character varying(50) NOT NULL,\n  "description" text,\n  "title" character varying(255) NOT NULL,\n  "status" character varying(50) NOT NULL DEFAULT 'pending'::character varying,\n  "vendor_id" uuid,\n  "organization_id" uuid,\n  "due_date" timestamp without time zone,\n  "owner_id" uuid,\n  "type" character varying(50),\n  "related_to_id" uuid,\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4()\n);
CREATE TABLE tasks_leases (  "task_id" uuid NOT NULL,\n  "lease_id" uuid NOT NULL\n);
CREATE TABLE tasks_properties (  "task_id" uuid NOT NULL,\n  "property_id" uuid NOT NULL\n);
CREATE TABLE tasks_related_tasks (  "related_task_id" uuid NOT NULL,\n  "task_id" uuid NOT NULL\n);
CREATE TABLE team_members (  "role_id" uuid,\n  "id" uuid NOT NULL DEFAULT gen_random_uuid(),\n  "job_title" character varying(100),\n  "department_id" uuid,\n  "updated_at" timestamp with time zone DEFAULT now(),\n  "created_at" timestamp with time zone DEFAULT now(),\n  "user_id" uuid NOT NULL\n);
CREATE TABLE tenants (  "background_check_passed" boolean,\n  "status" character varying(50) DEFAULT 'active'::character varying,\n  "emergency_contact_phone" character varying(50),\n  "emergency_contact_relationship" character varying(100),\n  "preferred_contact_methods" ARRAY,\n  "language_preference" character varying(50) DEFAULT 'English'::character varying,\n  "whatsapp_opt_in" boolean DEFAULT false,\n  "organization_id" uuid NOT NULL,\n  "background_check_date" date,\n  "emergency_contact" jsonb,\n  "eviction_history" boolean DEFAULT false,\n  "vehicles" jsonb,\n  "pets" jsonb,\n  "backgroundcheckdate" date,\n  "payment_history" jsonb,\n  "current_property_id" uuid,\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "created_at" timestamp without time zone DEFAULT now(),\n  "user_id" uuid,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "special_accommodations" text,\n  "background_check_status" character varying(50) DEFAULT 'pending'::character varying,\n  "email" character varying(255),\n  "phone" character varying(50),\n  "first_name" character varying(100),\n  "last_name" character varying(100),\n  "phone_number" text,\n  "whatsapp_number" text\n);
CREATE TABLE units (  "status" character varying(50) DEFAULT 'vacant'::character varying,\n  "last_inspection_date" date,\n  "maintenance" boolean NOT NULL DEFAULT false,\n  "organization_id" uuid NOT NULL,\n  "utility_meters" jsonb,\n  "maintenance_history" jsonb,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "property_id" uuid NOT NULL,\n  "area" integer(32,0),\n  "bedrooms" integer(32,0),\n  "bathrooms" numeric(2,1),\n  "rent_amount" numeric(10,2),\n  "created_at" timestamp without time zone DEFAULT now(),\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "unit_number" character varying(50),\n  "smart_lock_details" jsonb,\n  "smart_lock_enabled" boolean DEFAULT false,\n  "next_inspection_date" date,\n  "floor_plan" character varying(100)\n);
CREATE TABLE user_profiles (  "email_verified" boolean DEFAULT false,\n  "whatsapp_number" text,\n  "preferred_contact_time" character varying(50),\n  "organization_id" uuid,\n  "preferred_contact_methods" ARRAY DEFAULT ARRAY['email'::text],\n  "id" uuid NOT NULL,\n  "time_zone" character varying(50) DEFAULT 'UTC'::character varying,\n  "verification_status" character varying(20) DEFAULT 'unverified'::character varying,\n  "status" character varying(20) DEFAULT 'active'::character varying,\n  "profile_image_url" text,\n  "phone" character varying(50),\n  "last_name" character varying(100) NOT NULL,\n  "first_name" character varying(100) NOT NULL,\n  "email" character varying(255) NOT NULL,\n  "whatsapp_opt_in" boolean DEFAULT false,\n  "notification_preferences" jsonb,\n  "two_factor_enabled" boolean DEFAULT false,\n  "phone_verified" boolean DEFAULT false,\n  "last_login_at" timestamp with time zone,\n  "default_organization_id" uuid,\n  "updated_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP,\n  "created_at" timestamp with time zone DEFAULT CURRENT_TIMESTAMP\n);
CREATE TABLE user_roles (  "created_at" timestamp with time zone DEFAULT now(),\n  "updated_at" timestamp with time zone DEFAULT now(),\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "user_id" uuid,\n  "organization_id" uuid,\n  "role_id" uuid\n);
CREATE TABLE vendors (  "user_id" uuid,\n  "id" uuid NOT NULL DEFAULT uuid_generate_v4(),\n  "payment_terms" character varying(100),\n  "email" character varying(255),\n  "phone" character varying(50),\n  "vendor_name" text,\n  "service_availability" jsonb,\n  "service_areas" jsonb,\n  "service_type" character varying(100) NOT NULL,\n  "notes" text,\n  "contact_person_name" text,\n  "contact_person_email" text,\n  "contact_person_phone" character varying(50),\n  "organization_id" uuid NOT NULL,\n  "performance_rating" numeric(3,2),\n  "preferred_bank_account_id" uuid,\n  "business_type" character varying(100),\n  "emergency_service" boolean DEFAULT false,\n  "updated_at" timestamp without time zone DEFAULT now(),\n  "created_at" timestamp without time zone DEFAULT now(),\n  "hourly_rate" numeric\n);

ALTER TABLE activity_logs ADD CONSTRAINT activity_logs_pkey PRIMARY KEY (id);
ALTER TABLE announcement_background_tasks ADD CONSTRAINT announcement_background_tasks_pkey PRIMARY KEY (id);
ALTER TABLE announcement_jobs ADD CONSTRAINT announcement_jobs_pkey PRIMARY KEY (id);
ALTER TABLE announcement_schedules ADD CONSTRAINT announcement_schedules_pkey PRIMARY KEY (id);
ALTER TABLE announcement_targets ADD CONSTRAINT announcement_targets_pkey PRIMARY KEY (id);
ALTER TABLE announcement_types ADD CONSTRAINT announcement_types_pkey PRIMARY KEY (id);
ALTER TABLE announcements ADD CONSTRAINT announcements_pkey PRIMARY KEY (id);
ALTER TABLE bank_account_types ADD CONSTRAINT bank_account_types_pkey PRIMARY KEY (id);
ALTER TABLE bank_accounts ADD CONSTRAINT bank_accounts_pkey PRIMARY KEY (id);
ALTER TABLE communication_logs ADD CONSTRAINT communication_logs_pkey PRIMARY KEY (id);
ALTER TABLE demo_requests ADD CONSTRAINT demo_requests_pkey PRIMARY KEY (id);
ALTER TABLE departments ADD CONSTRAINT departments_pkey PRIMARY KEY (id);
ALTER TABLE documents ADD CONSTRAINT documents_pkey PRIMARY KEY (id);
ALTER TABLE expenses ADD CONSTRAINT expenses_pkey PRIMARY KEY (id);
ALTER TABLE financial_summaries ADD CONSTRAINT financial_summaries_pkey PRIMARY KEY (id);
ALTER TABLE invoice_items ADD CONSTRAINT invoice_items_pkey PRIMARY KEY (id);
ALTER TABLE invoice_payments ADD CONSTRAINT invoice_payments_pkey PRIMARY KEY (id);
ALTER TABLE invoices ADD CONSTRAINT invoices_pkey PRIMARY KEY (id);
ALTER TABLE lease_addendums ADD CONSTRAINT lease_addendums_pkey PRIMARY KEY (id);
ALTER TABLE lease_charges ADD CONSTRAINT lease_charges_pkey PRIMARY KEY (id);
ALTER TABLE lease_documents ADD CONSTRAINT lease_documents_pkey PRIMARY KEY (id);
ALTER TABLE lease_period_payments ADD CONSTRAINT lease_period_payments_pkey PRIMARY KEY (id);
ALTER TABLE lease_renewals ADD CONSTRAINT lease_renewals_pkey PRIMARY KEY (id);
ALTER TABLE leases ADD CONSTRAINT leases_pkey PRIMARY KEY (id);
ALTER TABLE maintenance_comments ADD CONSTRAINT maintenance_comments_pkey PRIMARY KEY (id);
ALTER TABLE maintenance_requests ADD CONSTRAINT maintenance_requests_pkey PRIMARY KEY (id);
ALTER TABLE maintenance_ticket_history ADD CONSTRAINT maintenance_ticket_history_pkey PRIMARY KEY (id);
ALTER TABLE maintenance_types ADD CONSTRAINT maintenance_types_pkey PRIMARY KEY (id);
ALTER TABLE notifications ADD CONSTRAINT notifications_pkey PRIMARY KEY (id);
ALTER TABLE organization_invitations ADD CONSTRAINT organization_invitations_pkey PRIMARY KEY (id);
ALTER TABLE organizations ADD CONSTRAINT organizations_pkey PRIMARY KEY (id);
ALTER TABLE owner_properties ADD CONSTRAINT owner_properties_pkey PRIMARY KEY (property_id, owner_id);
ALTER TABLE owners ADD CONSTRAINT owners_pkey PRIMARY KEY (id);
ALTER TABLE payment_categories ADD CONSTRAINT payment_categories_pkey PRIMARY KEY (id);
ALTER TABLE payment_methods ADD CONSTRAINT payment_methods_pkey PRIMARY KEY (id);
ALTER TABLE payment_schedules ADD CONSTRAINT payment_schedules_pkey PRIMARY KEY (id);
ALTER TABLE payment_transactions ADD CONSTRAINT payment_transactions_pkey PRIMARY KEY (id);
ALTER TABLE payments ADD CONSTRAINT payments_pkey PRIMARY KEY (id);
ALTER TABLE properties ADD CONSTRAINT properties_pkey PRIMARY KEY (id);
ALTER TABLE property_images ADD CONSTRAINT property_images_pkey PRIMARY KEY (id);
ALTER TABLE property_inspections ADD CONSTRAINT property_inspections_pkey PRIMARY KEY (id);
ALTER TABLE property_managers ADD CONSTRAINT property_managers_pkey PRIMARY KEY (id);
ALTER TABLE property_metrics ADD CONSTRAINT property_metrics_pkey PRIMARY KEY (id);
ALTER TABLE property_stakeholders ADD CONSTRAINT property_stakeholders_pkey PRIMARY KEY (id);
ALTER TABLE rental_application_documents ADD CONSTRAINT rental_application_documents_pkey PRIMARY KEY (id);
ALTER TABLE rental_applications ADD CONSTRAINT rental_applications_pkey PRIMARY KEY (id);
ALTER TABLE roles ADD CONSTRAINT roles_pkey PRIMARY KEY (id);
ALTER TABLE task_assignees ADD CONSTRAINT task_assignees_pkey PRIMARY KEY (user_id, task_id);
ALTER TABLE tasks ADD CONSTRAINT tasks_pkey PRIMARY KEY (id);
ALTER TABLE tasks_leases ADD CONSTRAINT tasks_leases_pkey PRIMARY KEY (task_id, lease_id);
ALTER TABLE tasks_properties ADD CONSTRAINT tasks_properties_pkey PRIMARY KEY (property_id, task_id);
ALTER TABLE tasks_related_tasks ADD CONSTRAINT tasks_related_tasks_pkey PRIMARY KEY (task_id, related_task_id);
ALTER TABLE team_members ADD CONSTRAINT team_members_pkey PRIMARY KEY (id);
ALTER TABLE tenants ADD CONSTRAINT tenants_pkey PRIMARY KEY (id);
ALTER TABLE units ADD CONSTRAINT units_pkey PRIMARY KEY (id);
ALTER TABLE user_profiles ADD CONSTRAINT user_profiles_pkey PRIMARY KEY (id);
ALTER TABLE user_roles ADD CONSTRAINT user_roles_pkey PRIMARY KEY (id);
ALTER TABLE vendors ADD CONSTRAINT vendors_pkey PRIMARY KEY (id);

ALTER TABLE activity_logs ADD CONSTRAINT activity_logs_user_id_fkey FOREIGN KEY (user_id) REFERENCES user_profiles(id);
ALTER TABLE activity_logs ADD CONSTRAINT activity_logs_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE activity_logs ADD CONSTRAINT activity_logs_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE activity_logs ADD CONSTRAINT activity_logs_unit_id_fkey FOREIGN KEY (unit_id) REFERENCES units(id);
ALTER TABLE announcement_background_tasks ADD CONSTRAINT announcement_background_tasks_announcement_id_fkey FOREIGN KEY (announcement_id) REFERENCES announcements(id);
ALTER TABLE announcement_background_tasks ADD CONSTRAINT announcement_background_tasks_job_id_fkey FOREIGN KEY (job_id) REFERENCES announcement_jobs(id);
ALTER TABLE announcement_jobs ADD CONSTRAINT announcement_jobs_announcement_id_fkey FOREIGN KEY (announcement_id) REFERENCES announcements(id);
ALTER TABLE announcement_schedules ADD CONSTRAINT announcement_schedules_announcement_id_fkey FOREIGN KEY (announcement_id) REFERENCES announcements(id);
ALTER TABLE announcement_targets ADD CONSTRAINT announcement_targets_announcement_id_fkey FOREIGN KEY (announcement_id) REFERENCES announcements(id);
ALTER TABLE announcement_targets ADD CONSTRAINT announcement_targets_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE announcement_types ADD CONSTRAINT announcement_types_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE announcements ADD CONSTRAINT announcements_author_id_fkey FOREIGN KEY (author_id) REFERENCES user_profiles(id);
ALTER TABLE announcements ADD CONSTRAINT announcements_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE bank_account_types ADD CONSTRAINT bank_account_types_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE bank_accounts ADD CONSTRAINT bank_accounts_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE bank_accounts ADD CONSTRAINT bank_accounts_account_type_id_fkey FOREIGN KEY (account_type_id) REFERENCES bank_account_types(id);
ALTER TABLE bank_accounts ADD CONSTRAINT bank_accounts_created_by_fkey FOREIGN KEY (created_by) REFERENCES user_profiles(id);
ALTER TABLE communication_logs ADD CONSTRAINT communication_logs_announcement_id_fkey FOREIGN KEY (announcement_id) REFERENCES announcements(id);
ALTER TABLE communication_logs ADD CONSTRAINT communication_logs_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE departments ADD CONSTRAINT departments_organization_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE departments ADD CONSTRAINT departments_role_fkey FOREIGN KEY (role_id) REFERENCES roles(id);
ALTER TABLE documents ADD CONSTRAINT documents_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE documents ADD CONSTRAINT documents_uploaded_by_fkey FOREIGN KEY (uploaded_by) REFERENCES user_profiles(id);
ALTER TABLE expenses ADD CONSTRAINT expenses_category_id_fkey FOREIGN KEY (category_id) REFERENCES payment_categories(id);
ALTER TABLE expenses ADD CONSTRAINT expenses_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE expenses ADD CONSTRAINT expenses_payment_method_id_fkey FOREIGN KEY (payment_method_id) REFERENCES payment_methods(id);
ALTER TABLE expenses ADD CONSTRAINT expenses_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE expenses ADD CONSTRAINT expenses_created_by_fkey FOREIGN KEY (created_by) REFERENCES user_profiles(id);
ALTER TABLE financial_summaries ADD CONSTRAINT financial_summaries_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE financial_summaries ADD CONSTRAINT financial_summaries_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE invoice_items ADD CONSTRAINT invoice_items_invoice_id_fkey FOREIGN KEY (invoice_id) REFERENCES invoices(id);
ALTER TABLE invoice_payments ADD CONSTRAINT invoice_payments_invoice_id_fkey FOREIGN KEY (invoice_id) REFERENCES invoices(id);
ALTER TABLE invoice_payments ADD CONSTRAINT invoice_payments_payment_id_fkey FOREIGN KEY (payment_id) REFERENCES payments(id);
ALTER TABLE invoices ADD CONSTRAINT invoices_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE invoices ADD CONSTRAINT invoices_unit_id_fkey FOREIGN KEY (unit_id) REFERENCES units(id);
ALTER TABLE invoices ADD CONSTRAINT invoices_created_by_fkey FOREIGN KEY (created_by) REFERENCES user_profiles(id);
ALTER TABLE invoices ADD CONSTRAINT invoices_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE lease_addendums ADD CONSTRAINT lease_addendums_lease_id_fkey FOREIGN KEY (lease_id) REFERENCES leases(id);
ALTER TABLE lease_addendums ADD CONSTRAINT lease_addendums_created_by_fkey FOREIGN KEY (created_by) REFERENCES user_profiles(id);
ALTER TABLE lease_charges ADD CONSTRAINT lease_charges_lease_id_fkey FOREIGN KEY (lease_id) REFERENCES leases(id);
ALTER TABLE lease_documents ADD CONSTRAINT lease_documents_lease_id_fkey FOREIGN KEY (lease_id) REFERENCES leases(id);
ALTER TABLE lease_period_payments ADD CONSTRAINT lease_period_payments_lease_id_fkey FOREIGN KEY (lease_id) REFERENCES leases(id);
ALTER TABLE lease_renewals ADD CONSTRAINT lease_renewals_original_lease_id_fkey FOREIGN KEY (original_lease_id) REFERENCES leases(id);
ALTER TABLE lease_renewals ADD CONSTRAINT lease_renewals_new_lease_id_fkey FOREIGN KEY (new_lease_id) REFERENCES leases(id);
ALTER TABLE leases ADD CONSTRAINT leases_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE leases ADD CONSTRAINT leases_unit_id_fkey FOREIGN KEY (unit_id) REFERENCES units(id);
ALTER TABLE leases ADD CONSTRAINT leases_issuer_id_fkey FOREIGN KEY (lease_issuer_id) REFERENCES user_profiles(id);
ALTER TABLE leases ADD CONSTRAINT leases_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES tenants(id);
ALTER TABLE maintenance_comments ADD CONSTRAINT maintenance_comments_ticket_id_fkey FOREIGN KEY (ticket_id) REFERENCES maintenance_requests(id);
ALTER TABLE maintenance_comments ADD CONSTRAINT maintenance_comments_commented_by_fkey FOREIGN KEY (commented_by) REFERENCES user_profiles(id);
ALTER TABLE maintenance_requests ADD CONSTRAINT maintenance_requests_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE maintenance_requests ADD CONSTRAINT maintenance_requests_assigned_to_fkey FOREIGN KEY (assigned_to) REFERENCES user_profiles(id);
ALTER TABLE maintenance_requests ADD CONSTRAINT maintenance_requests_maintenance_type_id_fkey FOREIGN KEY (maintenance_type_id) REFERENCES maintenance_types(id);
ALTER TABLE maintenance_requests ADD CONSTRAINT maintenance_requests_owner_id_fkey FOREIGN KEY (owner_id) REFERENCES user_profiles(id);
ALTER TABLE maintenance_requests ADD CONSTRAINT maintenance_requests_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES user_profiles(id);
ALTER TABLE maintenance_ticket_history ADD CONSTRAINT maintenance_ticket_history_ticket_id_fkey FOREIGN KEY (ticket_id) REFERENCES maintenance_requests(id);
ALTER TABLE maintenance_ticket_history ADD CONSTRAINT maintenance_ticket_history_changed_by_fkey FOREIGN KEY (changed_by) REFERENCES user_profiles(id);
ALTER TABLE maintenance_types ADD CONSTRAINT maintenance_types_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE notifications ADD CONSTRAINT notifications_user_id_fkey FOREIGN KEY (user_id) REFERENCES user_profiles(id);
ALTER TABLE organization_invitations ADD CONSTRAINT organization_invitations_role_id_fkey FOREIGN KEY (role_id) REFERENCES roles(id);
ALTER TABLE organization_invitations ADD CONSTRAINT organization_invitations_invited_by_fkey FOREIGN KEY (invited_by) REFERENCES user_profiles(id);
ALTER TABLE organization_invitations ADD CONSTRAINT organization_invitations_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE owner_properties ADD CONSTRAINT owner_properties_owner_id_fkey FOREIGN KEY (owner_id) REFERENCES owners(id);
ALTER TABLE owner_properties ADD CONSTRAINT owner_properties_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE owners ADD CONSTRAINT owners_user_id_fkey FOREIGN KEY (user_id) REFERENCES user_profiles(id);
ALTER TABLE owners ADD CONSTRAINT fk_owners_organization FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE owners ADD CONSTRAINT owners_bank_account_id_fkey FOREIGN KEY (bank_account_id) REFERENCES bank_accounts(id);
ALTER TABLE payment_categories ADD CONSTRAINT payment_categories_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE payment_methods ADD CONSTRAINT payment_methods_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE payment_schedules ADD CONSTRAINT payment_schedules_category_id_fkey FOREIGN KEY (category_id) REFERENCES payment_categories(id);
ALTER TABLE payment_schedules ADD CONSTRAINT payment_schedules_bank_account_id_fkey FOREIGN KEY (bank_account_id) REFERENCES bank_accounts(id);
ALTER TABLE payment_schedules ADD CONSTRAINT payment_schedules_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE payment_schedules ADD CONSTRAINT payment_schedules_lease_id_fkey FOREIGN KEY (lease_id) REFERENCES leases(id);
ALTER TABLE payment_schedules ADD CONSTRAINT payment_schedules_created_by_fkey FOREIGN KEY (created_by) REFERENCES user_profiles(id);
ALTER TABLE payment_transactions ADD CONSTRAINT payment_transactions_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE payment_transactions ADD CONSTRAINT payment_transactions_payment_id_fkey FOREIGN KEY (payment_id) REFERENCES payments(id);
ALTER TABLE payments ADD CONSTRAINT payments_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE payments ADD CONSTRAINT payments_leaseid_fkey FOREIGN KEY (lease_id) REFERENCES leases(id);
ALTER TABLE payments ADD CONSTRAINT payments_invoice_id_fkey FOREIGN KEY (invoice_id) REFERENCES invoices(id);
ALTER TABLE payments ADD CONSTRAINT payments_created_by_fkey FOREIGN KEY (created_by) REFERENCES user_profiles(id);
ALTER TABLE payments ADD CONSTRAINT payments_category_id_fkey FOREIGN KEY (category_id) REFERENCES payment_categories(id);
ALTER TABLE payments ADD CONSTRAINT payments_bank_account_id_fkey FOREIGN KEY (bank_account_id) REFERENCES bank_accounts(id);
ALTER TABLE payments ADD CONSTRAINT payments_payment_method_id_fkey FOREIGN KEY (payment_method_id) REFERENCES payment_methods(id);
ALTER TABLE properties ADD CONSTRAINT properties_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE properties ADD CONSTRAINT properties_owner_id_fkey FOREIGN KEY (owner_id) REFERENCES owners(id);
ALTER TABLE property_images ADD CONSTRAINT property_images_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE property_inspections ADD CONSTRAINT property_inspections_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE property_inspections ADD CONSTRAINT property_inspections_inspector_id_fkey FOREIGN KEY (inspector_id) REFERENCES user_profiles(id);
ALTER TABLE property_inspections ADD CONSTRAINT property_inspections_unit_id_fkey FOREIGN KEY (unit_id) REFERENCES units(id);
ALTER TABLE property_inspections ADD CONSTRAINT property_inspections_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE property_managers ADD CONSTRAINT property_managers_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE property_managers ADD CONSTRAINT property_managers_user_id_fkey FOREIGN KEY (user_id) REFERENCES user_profiles(id);
ALTER TABLE property_metrics ADD CONSTRAINT property_metrics_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE property_stakeholders ADD CONSTRAINT property_stakeholders_user_id_fkey FOREIGN KEY (user_id) REFERENCES user_profiles(id);
ALTER TABLE property_stakeholders ADD CONSTRAINT property_stakeholders_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE rental_application_documents ADD CONSTRAINT rental_application_documents_rental_application_id_fkey FOREIGN KEY (rental_application_id) REFERENCES rental_applications(id);
ALTER TABLE rental_application_documents ADD CONSTRAINT rental_application_documents_uploaded_by_fkey FOREIGN KEY (uploaded_by) REFERENCES user_profiles(id);
ALTER TABLE rental_applications ADD CONSTRAINT rental_applications_unit_id_fkey FOREIGN KEY (unit_id) REFERENCES units(id);
ALTER TABLE rental_applications ADD CONSTRAINT rental_applications_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE rental_applications ADD CONSTRAINT rental_applications_reviewed_by_fkey FOREIGN KEY (reviewed_by) REFERENCES user_profiles(id);
ALTER TABLE rental_applications ADD CONSTRAINT rental_applications_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE task_assignees ADD CONSTRAINT task_assignees_user_id_fkey FOREIGN KEY (user_id) REFERENCES user_profiles(id);
ALTER TABLE task_assignees ADD CONSTRAINT task_assignees_task_id_fkey FOREIGN KEY (task_id) REFERENCES tasks(id);
ALTER TABLE tasks ADD CONSTRAINT tasks_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE tasks ADD CONSTRAINT tasks_owner_id_fkey FOREIGN KEY (owner_id) REFERENCES user_profiles(id);
ALTER TABLE tasks ADD CONSTRAINT tasks_vendor_id_fkey FOREIGN KEY (vendor_id) REFERENCES vendors(id);
ALTER TABLE tasks_leases ADD CONSTRAINT tasks_leases_task_id_fkey FOREIGN KEY (task_id) REFERENCES tasks(id);
ALTER TABLE tasks_leases ADD CONSTRAINT tasks_leases_lease_id_fkey FOREIGN KEY (lease_id) REFERENCES leases(id);
ALTER TABLE tasks_properties ADD CONSTRAINT tasks_properties_task_id_fkey FOREIGN KEY (task_id) REFERENCES tasks(id);
ALTER TABLE tasks_properties ADD CONSTRAINT tasks_properties_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE tasks_related_tasks ADD CONSTRAINT tasks_related_tasks_related_task_id_fkey FOREIGN KEY (related_task_id) REFERENCES tasks(id);
ALTER TABLE tasks_related_tasks ADD CONSTRAINT tasks_related_tasks_task_id_fkey FOREIGN KEY (task_id) REFERENCES tasks(id);
ALTER TABLE team_members ADD CONSTRAINT team_members_role_id_fkey FOREIGN KEY (role_id) REFERENCES roles(id);
ALTER TABLE team_members ADD CONSTRAINT team_members_user_id_fkey FOREIGN KEY (user_id) REFERENCES user_profiles(id);
ALTER TABLE team_members ADD CONSTRAINT team_members_department_id_fkey FOREIGN KEY (department_id) REFERENCES departments(id);
ALTER TABLE tenants ADD CONSTRAINT tenants_current_property_id_fkey FOREIGN KEY (current_property_id) REFERENCES properties(id);
ALTER TABLE tenants ADD CONSTRAINT tenants_user_id_fkey FOREIGN KEY (user_id) REFERENCES user_profiles(id);
ALTER TABLE tenants ADD CONSTRAINT fk_tenants_organization FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE units ADD CONSTRAINT units_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE units ADD CONSTRAINT units_property_id_fkey FOREIGN KEY (property_id) REFERENCES properties(id);
ALTER TABLE user_profiles ADD CONSTRAINT user_profiles_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE user_profiles ADD CONSTRAINT user_profiles_default_organization_id_fkey FOREIGN KEY (default_organization_id) REFERENCES organizations(id);
ALTER TABLE user_roles ADD CONSTRAINT user_roles_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES organizations(id);
ALTER TABLE user_roles ADD CONSTRAINT user_roles_role_id_fkey FOREIGN KEY (role_id) REFERENCES roles(id);
ALTER TABLE user_roles ADD CONSTRAINT user_roles_user_id_fkey FOREIGN KEY (user_id) REFERENCES user_profiles(id);
ALTER TABLE vendors ADD CONSTRAINT vendors_preferred_bank_account_id_fkey FOREIGN KEY (preferred_bank_account_id) REFERENCES bank_accounts(id);
ALTER TABLE vendors ADD CONSTRAINT vendors_user_id_fkey FOREIGN KEY (user_id) REFERENCES user_profiles(id);
ALTER TABLE vendors ADD CONSTRAINT fk_vendors_organization FOREIGN KEY (organization_id) REFERENCES organizations(id);

ALTER TABLE financial_summaries ADD CONSTRAINT financial_summaries_organization_id_property_id_period_star_key UNIQUE (period_end, organization_id, property_id, period_start);
ALTER TABLE organization_invitations ADD CONSTRAINT organization_invitations_organization_id_email_status_key UNIQUE (organization_id, email, status);
ALTER TABLE organization_invitations ADD CONSTRAINT organization_invitations_token_key UNIQUE (token);
ALTER TABLE property_metrics ADD CONSTRAINT property_metrics_property_id_metric_date_key UNIQUE (property_id, metric_date);
ALTER TABLE property_stakeholders ADD CONSTRAINT property_stakeholders_property_id_user_id_stakeholder_type_key UNIQUE (stakeholder_type, property_id, user_id);
ALTER TABLE roles ADD CONSTRAINT roles_name_key UNIQUE (name);
ALTER TABLE units ADD CONSTRAINT units_property_id_unit_number_key UNIQUE (property_id, unit_number);
ALTER TABLE user_profiles ADD CONSTRAINT user_profiles_email_key UNIQUE (email);
ALTER TABLE user_roles ADD CONSTRAINT unique_user_role_organization UNIQUE (role_id, organization_id, user_id);
ALTER TABLE user_roles ADD CONSTRAINT user_roles_user_id_role_id_organization_id_key UNIQUE (user_id, role_id, organization_id);

CREATE INDEX idx_announcement_background_tasks_announcement_id ON public.announcement_background_tasks USING btree (announcement_id);
CREATE INDEX idx_announcement_background_tasks_job_id ON public.announcement_background_tasks USING btree (job_id);
CREATE INDEX idx_announcement_jobs_announcement_id ON public.announcement_jobs USING btree (announcement_id);
CREATE INDEX idx_announcement_schedules_next_run ON public.announcement_schedules USING btree (next_run);
CREATE INDEX idx_announcement_targets_announcement_id ON public.announcement_targets USING btree (announcement_id);
CREATE INDEX idx_announcement_targets_property_id ON public.announcement_targets USING btree (property_id);
CREATE INDEX idx_announcements_organization_id ON public.announcements USING btree (organization_id);
CREATE INDEX idx_expenses_category_id ON public.expenses USING btree (category_id);
CREATE INDEX idx_expenses_expense_date ON public.expenses USING btree (expense_date);
CREATE INDEX idx_expenses_property_id ON public.expenses USING btree (property_id);
CREATE INDEX idx_invoice_payments_invoice_id ON public.invoice_payments USING btree (invoice_id);
CREATE INDEX idx_invoice_payments_payment_id ON public.invoice_payments USING btree (payment_id);
CREATE INDEX idx_invoices_client_id ON public.invoices USING btree (client_id);
CREATE INDEX idx_invoices_due_date ON public.invoices USING btree (due_date);
CREATE INDEX idx_invoices_issue_date ON public.invoices USING btree (issue_date);
CREATE INDEX idx_invoices_property_id ON public.invoices USING btree (property_id);
CREATE INDEX idx_invoices_status ON public.invoices USING btree (status);
CREATE INDEX idx_lease_charges_lease_id ON public.lease_charges USING btree (lease_id);
CREATE INDEX no_overlapping_leases ON public.leases USING gist (unit_id, daterange(start_date, end_date, '[)'::text)) WHERE ((status)::text = 'Active'::text);
CREATE INDEX idx_notifications_created_at ON public.notifications USING btree (created_at);
CREATE INDEX idx_notifications_user_id_is_read ON public.notifications USING btree (user_id, is_read);
CREATE INDEX idx_payments_bank_account_id ON public.payments USING btree (bank_account_id);
CREATE INDEX idx_payments_category_id ON public.payments USING btree (category_id);
CREATE INDEX idx_payments_lease_id ON public.payments USING btree (lease_id);
CREATE INDEX idx_payments_payment_date ON public.payments USING btree (payment_date);
CREATE INDEX idx_payments_payment_type ON public.payments USING btree (payment_type);
CREATE INDEX idx_payments_status ON public.payments USING btree (status);

CREATE OR REPLACE FUNCTION public.cash_dist(money, money) RETURNS money AS $CREATE OR REPLACE FUNCTION public.cash_dist(money, money)                                                                                                                                                             +
RETURNS money                                                                                                                                                                                                                                                                                    +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$cash_dist$function$                                                                                                                                                                                                                                            +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.check_single_assignee_for_ticket() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.check_single_assignee_for_ticket()                                                                                                                                     +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
DECLARE                                                                                                                                                                                                                                                                                           +
task_type text;                                                                                                                                                                                                                                                                                 +
assignee_count integer;                                                                                                                                                                                                                                                                         +
BEGIN                                                                                                                                                                                                                                                                                             +
-- Get the type of the task for the current task_id                                                                                                                                                                                                                                             +
SELECT type INTO task_type FROM tasks WHERE id = NEW.task_id;                                                                                                                                                                                                                                   +
+
-- If the task is of type 'ticket', then count how many assignees already exist                                                                                                                                                                                                                 +
IF task_type = 'ticket' THEN                                                                                                                                                                                                                                                                    +
SELECT COUNT(*) INTO assignee_count                                                                                                                                                                                                                                                           +
FROM task_assignees                                                                                                                                                                                                                                                                           +
WHERE task_id = NEW.task_id;                                                                                                                                                                                                                                                                  +
+
IF assignee_count >= 1 THEN                                                                                                                                                                                                                                                                   +
RAISE EXCEPTION 'Only one assignee is allowed for tasks of type ticket (task_id: %)', NEW.task_id;                                                                                                                                                                                          +
END IF;                                                                                                                                                                                                                                                                                       +
END IF;                                                                                                                                                                                                                                                                                         +
+
RETURN NEW;                                                                                                                                                                                                                                                                                     +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.date_dist(date, date) RETURNS integer AS $CREATE OR REPLACE FUNCTION public.date_dist(date, date)                                                                                                                                                               +
RETURNS integer                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$date_dist$function$                                                                                                                                                                                                                                            +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.ensure_property_has_units() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.ensure_property_has_units()                                                                                                                                                   +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
-- Handle operations on units table                                                                                                                                                                                                                                                             +
IF TG_TABLE_NAME = 'units' THEN                                                                                                                                                                                                                                                                 +
DECLARE                                                                                                                                                                                                                                                                                       +
affected_property_id UUID;                                                                                                                                                                                                                                                                  +
unit_count INTEGER;                                                                                                                                                                                                                                                                         +
BEGIN                                                                                                                                                                                                                                                                                         +
-- Determine the property_id affected                                                                                                                                                                                                                                                       +
IF TG_OP = 'DELETE' THEN                                                                                                                                                                                                                                                                    +
affected_property_id := OLD.property_id;                                                                                                                                                                                                                                                  +
ELSIF TG_OP = 'UPDATE' THEN                                                                                                                                                                                                                                                                 +
-- If property_id is being changed, check the old property_id                                                                                                                                                                                                                             +
IF OLD.property_id IS DISTINCT FROM NEW.property_id THEN                                                                                                                                                                                                                                  +
affected_property_id := OLD.property_id;                                                                                                                                                                                                                                                +
ELSE                                                                                                                                                                                                                                                                                      +
RETURN NEW; -- No change to property_id, no action needed                                                                                                                                                                                                                               +
END IF;                                                                                                                                                                                                                                                                                   +
END IF;                                                                                                                                                                                                                                                                                     +
+
-- Count remaining units for the property                                                                                                                                                                                                                                                   +
SELECT COUNT(*)                                                                                                                                                                                                                                                                             +
INTO unit_count                                                                                                                                                                                                                                                                             +
FROM units                                                                                                                                                                                                                                                                                  +
WHERE property_id = affected_property_id;                                                                                                                                                                                                                                                   +
+
IF unit_count = 0 THEN                                                                                                                                                                                                                                                                      +
RAISE EXCEPTION 'Property % cannot be left with no units.', affected_property_id;                                                                                                                                                                                                         +
END IF;                                                                                                                                                                                                                                                                                     +
RETURN NEW;                                                                                                                                                                                                                                                                                 +
END;                                                                                                                                                                                                                                                                                          +
END IF;                                                                                                                                                                                                                                                                                         +
+
-- Return NULL for AFTER triggers (though we use BEFORE here)                                                                                                                                                                                                                                   +
RETURN NULL;                                                                                                                                                                                                                                                                                    +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.float4_dist(real, real) RETURNS real AS $CREATE OR REPLACE FUNCTION public.float4_dist(real, real)                                                                                                                                                              +
RETURNS real                                                                                                                                                                                                                                                                                     +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$float4_dist$function$                                                                                                                                                                                                                                          +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.float8_dist(double precision, double precision) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.float8_dist(double precision, double precision)                                                                                                  +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$float8_dist$function$                                                                                                                                                                                                                                          +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bit_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bit_compress(internal)                                                                                                                                                    +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bit_compress$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bit_consistent(internal, bit, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_bit_consistent(internal, bit, smallint, oid, internal)                                                                                     +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bit_consistent$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bit_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bit_penalty(internal, internal, internal)                                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bit_penalty$function$                                                                                                                                                                                                                                      +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bit_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bit_picksplit(internal, internal)                                                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bit_picksplit$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bit_same(gbtreekey_var, gbtreekey_var, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bit_same(gbtreekey_var, gbtreekey_var, internal)                                                                                                +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bit_same$function$                                                                                                                                                                                                                                         +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bit_union(internal, internal) RETURNS gbtreekey_var AS $CREATE OR REPLACE FUNCTION public.gbt_bit_union(internal, internal)                                                                                                                                 +
RETURNS gbtreekey_var                                                                                                                                                                                                                                                                            +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bit_union$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bool_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bool_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE STRICT                                                                                                                                                                                                                                                                                 +
AS '$libdir/btree_gist', $function$gbt_bool_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bool_consistent(internal, boolean, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_bool_consistent(internal, boolean, smallint, oid, internal)                                                                           +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE STRICT                                                                                                                                                                                                                                                                                 +
AS '$libdir/btree_gist', $function$gbt_bool_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bool_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bool_fetch(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE STRICT                                                                                                                                                                                                                                                                                 +
AS '$libdir/btree_gist', $function$gbt_bool_fetch$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bool_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bool_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE STRICT                                                                                                                                                                                                                                                                                 +
AS '$libdir/btree_gist', $function$gbt_bool_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bool_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bool_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE STRICT                                                                                                                                                                                                                                                                                 +
AS '$libdir/btree_gist', $function$gbt_bool_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bool_same(gbtreekey2, gbtreekey2, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bool_same(gbtreekey2, gbtreekey2, internal)                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE STRICT                                                                                                                                                                                                                                                                                 +
AS '$libdir/btree_gist', $function$gbt_bool_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bool_union(internal, internal) RETURNS gbtreekey2 AS $CREATE OR REPLACE FUNCTION public.gbt_bool_union(internal, internal)                                                                                                                                  +
RETURNS gbtreekey2                                                                                                                                                                                                                                                                               +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE STRICT                                                                                                                                                                                                                                                                                 +
AS '$libdir/btree_gist', $function$gbt_bool_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bpchar_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bpchar_compress(internal)                                                                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bpchar_compress$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bpchar_consistent(internal, character, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_bpchar_consistent(internal, character, smallint, oid, internal)                                                                   +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bpchar_consistent$function$                                                                                                                                                                                                                                +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bytea_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bytea_compress(internal)                                                                                                                                                +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bytea_compress$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bytea_consistent(internal, bytea, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_bytea_consistent(internal, bytea, smallint, oid, internal)                                                                             +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bytea_consistent$function$                                                                                                                                                                                                                                 +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bytea_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bytea_penalty(internal, internal, internal)                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bytea_penalty$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bytea_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bytea_picksplit(internal, internal)                                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bytea_picksplit$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bytea_same(gbtreekey_var, gbtreekey_var, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_bytea_same(gbtreekey_var, gbtreekey_var, internal)                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bytea_same$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_bytea_union(internal, internal) RETURNS gbtreekey_var AS $CREATE OR REPLACE FUNCTION public.gbt_bytea_union(internal, internal)                                                                                                                             +
RETURNS gbtreekey_var                                                                                                                                                                                                                                                                            +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_bytea_union$function$                                                                                                                                                                                                                                      +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_cash_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_cash_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_cash_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_cash_consistent(internal, money, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_cash_consistent(internal, money, smallint, oid, internal)                                                                               +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_cash_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_cash_distance(internal, money, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_cash_distance(internal, money, smallint, oid, internal)                                                                          +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_cash_distance$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_cash_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_cash_fetch(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_cash_fetch$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_cash_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_cash_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_cash_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_cash_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_cash_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_cash_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_cash_same(gbtreekey16, gbtreekey16, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_cash_same(gbtreekey16, gbtreekey16, internal)                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_cash_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_cash_union(internal, internal) RETURNS gbtreekey16 AS $CREATE OR REPLACE FUNCTION public.gbt_cash_union(internal, internal)                                                                                                                                 +
RETURNS gbtreekey16                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_cash_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_date_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_date_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_date_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_date_consistent(internal, date, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_date_consistent(internal, date, smallint, oid, internal)                                                                                 +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_date_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_date_distance(internal, date, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_date_distance(internal, date, smallint, oid, internal)                                                                            +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_date_distance$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_date_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_date_fetch(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_date_fetch$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_date_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_date_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_date_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_date_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_date_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_date_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_date_same(gbtreekey8, gbtreekey8, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_date_same(gbtreekey8, gbtreekey8, internal)                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_date_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_date_union(internal, internal) RETURNS gbtreekey8 AS $CREATE OR REPLACE FUNCTION public.gbt_date_union(internal, internal)                                                                                                                                  +
RETURNS gbtreekey8                                                                                                                                                                                                                                                                               +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_date_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_decompress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_decompress(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_decompress$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_enum_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_enum_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_enum_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_enum_consistent(internal, anyenum, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_enum_consistent(internal, anyenum, smallint, oid, internal)                                                                           +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_enum_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_enum_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_enum_fetch(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_enum_fetch$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_enum_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_enum_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_enum_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_enum_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_enum_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_enum_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_enum_same(gbtreekey8, gbtreekey8, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_enum_same(gbtreekey8, gbtreekey8, internal)                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_enum_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_enum_union(internal, internal) RETURNS gbtreekey8 AS $CREATE OR REPLACE FUNCTION public.gbt_enum_union(internal, internal)                                                                                                                                  +
RETURNS gbtreekey8                                                                                                                                                                                                                                                                               +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_enum_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float4_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_float4_compress(internal)                                                                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float4_compress$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float4_consistent(internal, real, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_float4_consistent(internal, real, smallint, oid, internal)                                                                             +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float4_consistent$function$                                                                                                                                                                                                                                +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float4_distance(internal, real, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_float4_distance(internal, real, smallint, oid, internal)                                                                        +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float4_distance$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float4_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_float4_fetch(internal)                                                                                                                                                    +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float4_fetch$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float4_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_float4_penalty(internal, internal, internal)                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float4_penalty$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float4_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_float4_picksplit(internal, internal)                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float4_picksplit$function$                                                                                                                                                                                                                                 +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float4_same(gbtreekey8, gbtreekey8, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_float4_same(gbtreekey8, gbtreekey8, internal)                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float4_same$function$                                                                                                                                                                                                                                      +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float4_union(internal, internal) RETURNS gbtreekey8 AS $CREATE OR REPLACE FUNCTION public.gbt_float4_union(internal, internal)                                                                                                                              +
RETURNS gbtreekey8                                                                                                                                                                                                                                                                               +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float4_union$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float8_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_float8_compress(internal)                                                                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float8_compress$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float8_consistent(internal, double precision, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_float8_consistent(internal, double precision, smallint, oid, internal)                                                     +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float8_consistent$function$                                                                                                                                                                                                                                +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float8_distance(internal, double precision, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_float8_distance(internal, double precision, smallint, oid, internal)                                                +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float8_distance$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float8_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_float8_fetch(internal)                                                                                                                                                    +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float8_fetch$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float8_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_float8_penalty(internal, internal, internal)                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float8_penalty$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float8_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_float8_picksplit(internal, internal)                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float8_picksplit$function$                                                                                                                                                                                                                                 +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float8_same(gbtreekey16, gbtreekey16, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_float8_same(gbtreekey16, gbtreekey16, internal)                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float8_same$function$                                                                                                                                                                                                                                      +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_float8_union(internal, internal) RETURNS gbtreekey16 AS $CREATE OR REPLACE FUNCTION public.gbt_float8_union(internal, internal)                                                                                                                             +
RETURNS gbtreekey16                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_float8_union$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_inet_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_inet_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_inet_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_inet_consistent(internal, inet, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_inet_consistent(internal, inet, smallint, oid, internal)                                                                                 +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_inet_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_inet_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_inet_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_inet_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_inet_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_inet_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_inet_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_inet_same(gbtreekey16, gbtreekey16, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_inet_same(gbtreekey16, gbtreekey16, internal)                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_inet_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_inet_union(internal, internal) RETURNS gbtreekey16 AS $CREATE OR REPLACE FUNCTION public.gbt_inet_union(internal, internal)                                                                                                                                 +
RETURNS gbtreekey16                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_inet_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int2_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int2_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int2_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int2_consistent(internal, smallint, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_int2_consistent(internal, smallint, smallint, oid, internal)                                                                         +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int2_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int2_distance(internal, smallint, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_int2_distance(internal, smallint, smallint, oid, internal)                                                                    +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int2_distance$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int2_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int2_fetch(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int2_fetch$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int2_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int2_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int2_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int2_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int2_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int2_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int2_same(gbtreekey4, gbtreekey4, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int2_same(gbtreekey4, gbtreekey4, internal)                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int2_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int2_union(internal, internal) RETURNS gbtreekey4 AS $CREATE OR REPLACE FUNCTION public.gbt_int2_union(internal, internal)                                                                                                                                  +
RETURNS gbtreekey4                                                                                                                                                                                                                                                                               +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int2_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int4_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int4_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int4_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int4_consistent(internal, integer, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_int4_consistent(internal, integer, smallint, oid, internal)                                                                           +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int4_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int4_distance(internal, integer, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_int4_distance(internal, integer, smallint, oid, internal)                                                                      +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int4_distance$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int4_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int4_fetch(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int4_fetch$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int4_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int4_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int4_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int4_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int4_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int4_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int4_same(gbtreekey8, gbtreekey8, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int4_same(gbtreekey8, gbtreekey8, internal)                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int4_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int4_union(internal, internal) RETURNS gbtreekey8 AS $CREATE OR REPLACE FUNCTION public.gbt_int4_union(internal, internal)                                                                                                                                  +
RETURNS gbtreekey8                                                                                                                                                                                                                                                                               +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int4_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int8_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int8_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int8_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int8_consistent(internal, bigint, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_int8_consistent(internal, bigint, smallint, oid, internal)                                                                             +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int8_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int8_distance(internal, bigint, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_int8_distance(internal, bigint, smallint, oid, internal)                                                                        +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int8_distance$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int8_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int8_fetch(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int8_fetch$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int8_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int8_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int8_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int8_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int8_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int8_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int8_same(gbtreekey16, gbtreekey16, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_int8_same(gbtreekey16, gbtreekey16, internal)                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int8_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_int8_union(internal, internal) RETURNS gbtreekey16 AS $CREATE OR REPLACE FUNCTION public.gbt_int8_union(internal, internal)                                                                                                                                 +
RETURNS gbtreekey16                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_int8_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_intv_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_intv_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_intv_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_intv_consistent(internal, interval, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_intv_consistent(internal, interval, smallint, oid, internal)                                                                         +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_intv_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_intv_decompress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_intv_decompress(internal)                                                                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_intv_decompress$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_intv_distance(internal, interval, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_intv_distance(internal, interval, smallint, oid, internal)                                                                    +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_intv_distance$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_intv_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_intv_fetch(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_intv_fetch$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_intv_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_intv_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_intv_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_intv_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_intv_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_intv_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_intv_same(gbtreekey32, gbtreekey32, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_intv_same(gbtreekey32, gbtreekey32, internal)                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_intv_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_intv_union(internal, internal) RETURNS gbtreekey32 AS $CREATE OR REPLACE FUNCTION public.gbt_intv_union(internal, internal)                                                                                                                                 +
RETURNS gbtreekey32                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_intv_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad8_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_macad8_compress(internal)                                                                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad8_compress$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad8_consistent(internal, macaddr8, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_macad8_consistent(internal, macaddr8, smallint, oid, internal)                                                                     +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad8_consistent$function$                                                                                                                                                                                                                                +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad8_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_macad8_fetch(internal)                                                                                                                                                    +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad8_fetch$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad8_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_macad8_penalty(internal, internal, internal)                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad8_penalty$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad8_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_macad8_picksplit(internal, internal)                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad8_picksplit$function$                                                                                                                                                                                                                                 +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad8_same(gbtreekey16, gbtreekey16, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_macad8_same(gbtreekey16, gbtreekey16, internal)                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad8_same$function$                                                                                                                                                                                                                                      +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad8_union(internal, internal) RETURNS gbtreekey16 AS $CREATE OR REPLACE FUNCTION public.gbt_macad8_union(internal, internal)                                                                                                                             +
RETURNS gbtreekey16                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad8_union$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_macad_compress(internal)                                                                                                                                                +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad_compress$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad_consistent(internal, macaddr, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_macad_consistent(internal, macaddr, smallint, oid, internal)                                                                         +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad_consistent$function$                                                                                                                                                                                                                                 +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_macad_fetch(internal)                                                                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad_fetch$function$                                                                                                                                                                                                                                      +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_macad_penalty(internal, internal, internal)                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad_penalty$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_macad_picksplit(internal, internal)                                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad_picksplit$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad_same(gbtreekey16, gbtreekey16, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_macad_same(gbtreekey16, gbtreekey16, internal)                                                                                                    +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad_same$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_macad_union(internal, internal) RETURNS gbtreekey16 AS $CREATE OR REPLACE FUNCTION public.gbt_macad_union(internal, internal)                                                                                                                               +
RETURNS gbtreekey16                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_macad_union$function$                                                                                                                                                                                                                                      +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_numeric_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_numeric_compress(internal)                                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_numeric_compress$function$                                                                                                                                                                                                                                 +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_numeric_consistent(internal, numeric, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_numeric_consistent(internal, numeric, smallint, oid, internal)                                                                     +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_numeric_consistent$function$                                                                                                                                                                                                                               +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_numeric_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_numeric_penalty(internal, internal, internal)                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_numeric_penalty$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_numeric_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_numeric_picksplit(internal, internal)                                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_numeric_picksplit$function$                                                                                                                                                                                                                                +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_numeric_same(gbtreekey_var, gbtreekey_var, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_numeric_same(gbtreekey_var, gbtreekey_var, internal)                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_numeric_same$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_numeric_union(internal, internal) RETURNS gbtreekey_var AS $CREATE OR REPLACE FUNCTION public.gbt_numeric_union(internal, internal)                                                                                                                         +
RETURNS gbtreekey_var                                                                                                                                                                                                                                                                            +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_numeric_union$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_oid_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_oid_compress(internal)                                                                                                                                                    +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_oid_compress$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_oid_consistent(internal, oid, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_oid_consistent(internal, oid, smallint, oid, internal)                                                                                     +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_oid_consistent$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_oid_distance(internal, oid, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_oid_distance(internal, oid, smallint, oid, internal)                                                                                +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_oid_distance$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_oid_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_oid_fetch(internal)                                                                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_oid_fetch$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_oid_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_oid_penalty(internal, internal, internal)                                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_oid_penalty$function$                                                                                                                                                                                                                                      +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_oid_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_oid_picksplit(internal, internal)                                                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_oid_picksplit$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_oid_same(gbtreekey8, gbtreekey8, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_oid_same(gbtreekey8, gbtreekey8, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_oid_same$function$                                                                                                                                                                                                                                         +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_oid_union(internal, internal) RETURNS gbtreekey8 AS $CREATE OR REPLACE FUNCTION public.gbt_oid_union(internal, internal)                                                                                                                                    +
RETURNS gbtreekey8                                                                                                                                                                                                                                                                               +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_oid_union$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_text_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_text_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_text_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_text_consistent(internal, text, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_text_consistent(internal, text, smallint, oid, internal)                                                                                 +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_text_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_text_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_text_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_text_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_text_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_text_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_text_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_text_same(gbtreekey_var, gbtreekey_var, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_text_same(gbtreekey_var, gbtreekey_var, internal)                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_text_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_text_union(internal, internal) RETURNS gbtreekey_var AS $CREATE OR REPLACE FUNCTION public.gbt_text_union(internal, internal)                                                                                                                               +
RETURNS gbtreekey_var                                                                                                                                                                                                                                                                            +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_text_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_time_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_time_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_time_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_time_consistent(internal, time without time zone, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_time_consistent(internal, time without time zone, smallint, oid, internal)                                             +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_time_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_time_distance(internal, time without time zone, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_time_distance(internal, time without time zone, smallint, oid, internal)                                        +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_time_distance$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_time_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_time_fetch(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_time_fetch$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_time_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_time_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_time_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_time_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_time_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_time_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_time_same(gbtreekey16, gbtreekey16, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_time_same(gbtreekey16, gbtreekey16, internal)                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_time_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_time_union(internal, internal) RETURNS gbtreekey16 AS $CREATE OR REPLACE FUNCTION public.gbt_time_union(internal, internal)                                                                                                                                 +
RETURNS gbtreekey16                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_time_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_timetz_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_timetz_compress(internal)                                                                                                                                              +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_timetz_compress$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_timetz_consistent(internal, time with time zone, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_timetz_consistent(internal, time with time zone, smallint, oid, internal)                                               +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_timetz_consistent$function$                                                                                                                                                                                                                                +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_ts_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_ts_compress(internal)                                                                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_ts_compress$function$                                                                                                                                                                                                                                      +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_ts_consistent(internal, timestamp without time zone, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_ts_consistent(internal, timestamp without time zone, smallint, oid, internal)                                       +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_ts_consistent$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_ts_distance(internal, timestamp without time zone, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_ts_distance(internal, timestamp without time zone, smallint, oid, internal)                                  +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_ts_distance$function$                                                                                                                                                                                                                                      +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_ts_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_ts_fetch(internal)                                                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_ts_fetch$function$                                                                                                                                                                                                                                         +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_ts_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_ts_penalty(internal, internal, internal)                                                                                                                +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_ts_penalty$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_ts_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_ts_picksplit(internal, internal)                                                                                                                                +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_ts_picksplit$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_ts_same(gbtreekey16, gbtreekey16, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_ts_same(gbtreekey16, gbtreekey16, internal)                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_ts_same$function$                                                                                                                                                                                                                                          +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_ts_union(internal, internal) RETURNS gbtreekey16 AS $CREATE OR REPLACE FUNCTION public.gbt_ts_union(internal, internal)                                                                                                                                     +
RETURNS gbtreekey16                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_ts_union$function$                                                                                                                                                                                                                                         +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_tstz_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_tstz_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_tstz_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_tstz_consistent(internal, timestamp with time zone, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_tstz_consistent(internal, timestamp with time zone, smallint, oid, internal)                                         +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_tstz_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_tstz_distance(internal, timestamp with time zone, smallint, oid, internal) RETURNS double precision AS $CREATE OR REPLACE FUNCTION public.gbt_tstz_distance(internal, timestamp with time zone, smallint, oid, internal)                                    +
RETURNS double precision                                                                                                                                                                                                                                                                         +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_tstz_distance$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_uuid_compress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_uuid_compress(internal)                                                                                                                                                  +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_uuid_compress$function$                                                                                                                                                                                                                                    +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_uuid_consistent(internal, uuid, smallint, oid, internal) RETURNS boolean AS $CREATE OR REPLACE FUNCTION public.gbt_uuid_consistent(internal, uuid, smallint, oid, internal)                                                                                 +
RETURNS boolean                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_uuid_consistent$function$                                                                                                                                                                                                                                  +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_uuid_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_uuid_fetch(internal)                                                                                                                                                        +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_uuid_fetch$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_uuid_penalty(internal, internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_uuid_penalty(internal, internal, internal)                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_uuid_penalty$function$                                                                                                                                                                                                                                     +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_uuid_picksplit(internal, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_uuid_picksplit(internal, internal)                                                                                                                            +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_uuid_picksplit$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_uuid_same(gbtreekey32, gbtreekey32, internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_uuid_same(gbtreekey32, gbtreekey32, internal)                                                                                                      +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_uuid_same$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_uuid_union(internal, internal) RETURNS gbtreekey32 AS $CREATE OR REPLACE FUNCTION public.gbt_uuid_union(internal, internal)                                                                                                                                 +
RETURNS gbtreekey32                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_uuid_union$function$                                                                                                                                                                                                                                       +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_var_decompress(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_var_decompress(internal)                                                                                                                                                +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_var_decompress$function$                                                                                                                                                                                                                                   +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbt_var_fetch(internal) RETURNS internal AS $CREATE OR REPLACE FUNCTION public.gbt_var_fetch(internal)                                                                                                                                                          +
RETURNS internal                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbt_var_fetch$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey16_in(cstring) RETURNS gbtreekey16 AS $CREATE OR REPLACE FUNCTION public.gbtreekey16_in(cstring)                                                                                                                                                       +
RETURNS gbtreekey16                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_in$function$                                                                                                                                                                                                                                         +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey16_out(gbtreekey16) RETURNS cstring AS $CREATE OR REPLACE FUNCTION public.gbtreekey16_out(gbtreekey16)                                                                                                                                                 +
RETURNS cstring                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_out$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey2_in(cstring) RETURNS gbtreekey2 AS $CREATE OR REPLACE FUNCTION public.gbtreekey2_in(cstring)                                                                                                                                                          +
RETURNS gbtreekey2                                                                                                                                                                                                                                                                               +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_in$function$                                                                                                                                                                                                                                         +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey2_out(gbtreekey2) RETURNS cstring AS $CREATE OR REPLACE FUNCTION public.gbtreekey2_out(gbtreekey2)                                                                                                                                                     +
RETURNS cstring                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_out$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey32_in(cstring) RETURNS gbtreekey32 AS $CREATE OR REPLACE FUNCTION public.gbtreekey32_in(cstring)                                                                                                                                                       +
RETURNS gbtreekey32                                                                                                                                                                                                                                                                              +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_in$function$                                                                                                                                                                                                                                         +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey32_out(gbtreekey32) RETURNS cstring AS $CREATE OR REPLACE FUNCTION public.gbtreekey32_out(gbtreekey32)                                                                                                                                                 +
RETURNS cstring                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_out$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey4_in(cstring) RETURNS gbtreekey4 AS $CREATE OR REPLACE FUNCTION public.gbtreekey4_in(cstring)                                                                                                                                                          +
RETURNS gbtreekey4                                                                                                                                                                                                                                                                               +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_in$function$                                                                                                                                                                                                                                         +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey4_out(gbtreekey4) RETURNS cstring AS $CREATE OR REPLACE FUNCTION public.gbtreekey4_out(gbtreekey4)                                                                                                                                                     +
RETURNS cstring                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_out$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey8_in(cstring) RETURNS gbtreekey8 AS $CREATE OR REPLACE FUNCTION public.gbtreekey8_in(cstring)                                                                                                                                                          +
RETURNS gbtreekey8                                                                                                                                                                                                                                                                               +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_in$function$                                                                                                                                                                                                                                         +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey8_out(gbtreekey8) RETURNS cstring AS $CREATE OR REPLACE FUNCTION public.gbtreekey8_out(gbtreekey8)                                                                                                                                                     +
RETURNS cstring                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_out$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey_var_in(cstring) RETURNS gbtreekey_var AS $CREATE OR REPLACE FUNCTION public.gbtreekey_var_in(cstring)                                                                                                                                                 +
RETURNS gbtreekey_var                                                                                                                                                                                                                                                                            +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_in$function$                                                                                                                                                                                                                                         +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.gbtreekey_var_out(gbtreekey_var) RETURNS cstring AS $CREATE OR REPLACE FUNCTION public.gbtreekey_var_out(gbtreekey_var)                                                                                                                                         +
RETURNS cstring                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$gbtreekey_out$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.get_announcement_tenant_contacts(announcement_id uuid) RETURNS TABLE(id uuid, email text, phone_number text, whatsapp_number text, first_name text, last_name text) AS $CREATE OR REPLACE FUNCTION public.get_announcement_tenant_contacts(announcement_id uuid)+
RETURNS TABLE(id uuid, email text, phone_number text, whatsapp_number text, first_name text, last_name text)                                                                                                                                                                                     +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
RETURN QUERY                                                                                                                                                                                                                                                                                    +
WITH announcement_properties AS (                                                                                                                                                                                                                                                               +
-- Get all properties targeted by this announcement                                                                                                                                                                                                                                           +
SELECT DISTINCT property_id                                                                                                                                                                                                                                                                   +
FROM announcement_targets                                                                                                                                                                                                                                                                     +
WHERE announcement_id = $1                                                                                                                                                                                                                                                                    +
AND target_type = 'property'                                                                                                                                                                                                                                                                +
AND property_id IS NOT NULL                                                                                                                                                                                                                                                                 +
),                                                                                                                                                                                                                                                                                              +
target_tenants AS (                                                                                                                                                                                                                                                                             +
-- Get all tenants directly targeted                                                                                                                                                                                                                                                          +
SELECT target_id AS tenant_id                                                                                                                                                                                                                                                                 +
FROM announcement_targets                                                                                                                                                                                                                                                                     +
WHERE announcement_id = $1                                                                                                                                                                                                                                                                    +
AND target_type = 'tenant'                                                                                                                                                                                                                                                                  +
AND target_id IS NOT NULL                                                                                                                                                                                                                                                                   +
+
UNION                                                                                                                                                                                                                                                                                         +
+
-- Get all tenants with active leases in the targeted properties                                                                                                                                                                                                                              +
SELECT DISTINCT l.tenant_id                                                                                                                                                                                                                                                                   +
FROM leases l                                                                                                                                                                                                                                                                                 +
JOIN units u ON l.unit_id = u.id                                                                                                                                                                                                                                                              +
JOIN announcement_properties ap ON u.property_id = ap.property_id                                                                                                                                                                                                                             +
WHERE l.status = 'Active'                                                                                                                                                                                                                                                                     +
)                                                                                                                                                                                                                                                                                               +
-- Get contact details for all target tenants (removing duplicates)                                                                                                                                                                                                                             +
SELECT DISTINCT t.id, t.email, t.phone_number, t.whatsapp_number, t.first_name, t.last_name                                                                                                                                                                                                     +
FROM tenants t                                                                                                                                                                                                                                                                                  +
JOIN target_tenants tt ON t.id = tt.tenant_id                                                                                                                                                                                                                                                   +
WHERE                                                                                                                                                                                                                                                                                           +
-- At least one contact method must be available                                                                                                                                                                                                                                              +
(t.email IS NOT NULL OR t.phone_number IS NOT NULL OR t.whatsapp_number IS NOT NULL);                                                                                                                                                                                                         +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.get_tenant_contact_counts(property_ids uuid[]) RETURNS json AS $CREATE OR REPLACE FUNCTION public.get_tenant_contact_counts(property_ids uuid[])                                                                                                                +
RETURNS json                                                                                                                                                                                                                                                                                     +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
DECLARE                                                                                                                                                                                                                                                                                           +
result JSON;                                                                                                                                                                                                                                                                                    +
BEGIN                                                                                                                                                                                                                                                                                             +
SELECT json_build_object(                                                                                                                                                                                                                                                                       +
'email', COUNT(DISTINCT t.id) FILTER (WHERE t.email IS NOT NULL),                                                                                                                                                                                                                             +
'sms', COUNT(DISTINCT t.id) FILTER (WHERE t.phone_number IS NOT NULL),                                                                                                                                                                                                                        +
'whatsapp', COUNT(DISTINCT t.id) FILTER (WHERE t.whatsapp_number IS NOT NULL),                                                                                                                                                                                                                +
'total', COUNT(DISTINCT t.id)                                                                                                                                                                                                                                                                 +
) INTO result                                                                                                                                                                                                                                                                                   +
FROM tenants t                                                                                                                                                                                                                                                                                  +
JOIN leases l ON t.id = l.tenant_id                                                                                                                                                                                                                                                             +
JOIN units u ON l.unit_id = u.id                                                                                                                                                                                                                                                                +
WHERE u.property_id = ANY(property_ids)                                                                                                                                                                                                                                                         +
AND l.status = 'Active';                                                                                                                                                                                                                                                                        +
+
RETURN result;                                                                                                                                                                                                                                                                                  +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.handle_lease_deletion() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.handle_lease_deletion()                                                                                                                                                           +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
-- Delete associated payment records from lease_period_payments                                                                                                                                                                                                                                 +
DELETE FROM lease_period_payments                                                                                                                                                                                                                                                               +
WHERE lease_id = OLD.id;                                                                                                                                                                                                                                                                        +
+
-- Note: lease_charges records are automatically deleted due to ON DELETE CASCADE                                                                                                                                                                                                               +
-- Optionally, you could add logic here for logging or additional cleanup if needed                                                                                                                                                                                                             +
-- For example:                                                                                                                                                                                                                                                                                 +
-- INSERT INTO audit_log (event, lease_id, timestamp)                                                                                                                                                                                                                                           +
-- VALUES ('Lease Deleted', OLD.id, NOW());                                                                                                                                                                                                                                                     +
+
RETURN OLD;                                                                                                                                                                                                                                                                                     +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.handle_new_user() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.handle_new_user()                                                                                                                                                                       +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
SECURITY DEFINER                                                                                                                                                                                                                                                                                 +
AS $function$DECLARE                                                                                                                                                                                                                                                                              +
org_id UUID;                                                                                                                                                                                                                                                                                    +
BEGIN                                                                                                                                                                                                                                                                                             +
-- Create user profile                                                                                                                                                                                                                                                                          +
INSERT INTO public.user_profiles (                                                                                                                                                                                                                                                              +
id,                                                                                                                                                                                                                                                                                           +
email,                                                                                                                                                                                                                                                                                        +
first_name,                                                                                                                                                                                                                                                                                   +
last_name,                                                                                                                                                                                                                                                                                    +
created_at,                                                                                                                                                                                                                                                                                   +
updated_at                                                                                                                                                                                                                                                                                    +
)                                                                                                                                                                                                                                                                                               +
VALUES (                                                                                                                                                                                                                                                                                        +
NEW.id,                                                                                                                                                                                                                                                                                       +
NEW.email,                                                                                                                                                                                                                                                                                    +
COALESCE(NEW.raw_user_meta_data ->> 'first_name', ''),                                                                                                                                                                                                                                        +
COALESCE(NEW.raw_user_meta_data ->> 'last_name', ''),                                                                                                                                                                                                                                         +
NOW(),                                                                                                                                                                                                                                                                                        +
NOW()                                                                                                                                                                                                                                                                                         +
);                                                                                                                                                                                                                                                                                              +
+
-- Only handle organization admin creation in trigger                                                                                                                                                                                                                                           +
IF NEW.raw_user_meta_data ->> 'organization_name' IS NOT NULL AND                                                                                                                                                                                                                               +
(NEW.raw_user_meta_data ->> 'is_organization_admin')::boolean = true THEN                                                                                                                                                                                                                    +
+
-- Create organization                                                                                                                                                                                                                                                                        +
INSERT INTO public.organizations (name)                                                                                                                                                                                                                                                       +
VALUES (NEW.raw_user_meta_data ->> 'organization_name')                                                                                                                                                                                                                                       +
RETURNING id INTO org_id;                                                                                                                                                                                                                                                                     +
+
-- Update user profile with organization                                                                                                                                                                                                                                                      +
UPDATE public.user_profiles                                                                                                                                                                                                                                                                   +
SET organization_id = org_id                                                                                                                                                                                                                                                                  +
WHERE id = NEW.id;                                                                                                                                                                                                                                                                            +
+
-- Add admin role                                                                                                                                                                                                                                                                             +
INSERT INTO public.user_roles (user_id, role_id, organization_id)                                                                                                                                                                                                                             +
SELECT NEW.id, id, org_id                                                                                                                                                                                                                                                                     +
FROM public.roles                                                                                                                                                                                                                                                                             +
WHERE name = 'organization_admin' AND is_system_role = true                                                                                                                                                                                                                                   +
LIMIT 1;                                                                                                                                                                                                                                                                                      +
END IF;                                                                                                                                                                                                                                                                                         +
+
RETURN NEW;                                                                                                                                                                                                                                                                                     +
END;$function$                                                                                                                                                                                                                                                                                    +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.int2_dist(smallint, smallint) RETURNS smallint AS $CREATE OR REPLACE FUNCTION public.int2_dist(smallint, smallint)                                                                                                                                              +
RETURNS smallint                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$int2_dist$function$                                                                                                                                                                                                                                            +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.int4_dist(integer, integer) RETURNS integer AS $CREATE OR REPLACE FUNCTION public.int4_dist(integer, integer)                                                                                                                                                   +
RETURNS integer                                                                                                                                                                                                                                                                                  +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$int4_dist$function$                                                                                                                                                                                                                                            +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.int8_dist(bigint, bigint) RETURNS bigint AS $CREATE OR REPLACE FUNCTION public.int8_dist(bigint, bigint)                                                                                                                                                        +
RETURNS bigint                                                                                                                                                                                                                                                                                   +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$int8_dist$function$                                                                                                                                                                                                                                            +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.interval_dist(interval, interval) RETURNS interval AS $CREATE OR REPLACE FUNCTION public.interval_dist(interval, interval)                                                                                                                                      +
RETURNS interval                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$interval_dist$function$                                                                                                                                                                                                                                        +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.manage_lease_payments() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.manage_lease_payments()                                                                                                                                                           +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
DECLARE                                                                                                                                                                                                                                                                                           +
needs_regeneration boolean;                                                                                                                                                                                                                                                                     +
lease_duration interval;                                                                                                                                                                                                                                                                        +
payment_interval interval;                                                                                                                                                                                                                                                                      +
BEGIN                                                                                                                                                                                                                                                                                             +
-- Determine if regeneration is needed                                                                                                                                                                                                                                                          +
IF TG_OP = 'INSERT' THEN                                                                                                                                                                                                                                                                        +
needs_regeneration := true;                                                                                                                                                                                                                                                                   +
ELSIF TG_OP = 'UPDATE' THEN                                                                                                                                                                                                                                                                     +
needs_regeneration := (                                                                                                                                                                                                                                                                       +
OLD.start_date IS DISTINCT FROM NEW.start_date OR                                                                                                                                                                                                                                           +
OLD.end_date IS DISTINCT FROM NEW.end_date OR                                                                                                                                                                                                                                               +
OLD.lease_terms IS DISTINCT FROM NEW.lease_terms OR                                                                                                                                                                                                                                         +
OLD.payment_frequency IS DISTINCT FROM NEW.payment_frequency OR                                                                                                                                                                                                                             +
OLD.payment_date IS DISTINCT FROM NEW.payment_date                                                                                                                                                                                                                                          +
);                                                                                                                                                                                                                                                                                            +
END IF;                                                                                                                                                                                                                                                                                         +
+
IF needs_regeneration THEN                                                                                                                                                                                                                                                                      +
-- Delete existing payment records                                                                                                                                                                                                                                                            +
DELETE FROM lease_period_payments WHERE lease_id = NEW.id;                                                                                                                                                                                                                                    +
+
-- Set payment interval based on frequency                                                                                                                                                                                                                                                    +
payment_interval := CASE NEW.payment_frequency                                                                                                                                                                                                                                                +
WHEN 'Daily' THEN '1 day'::INTERVAL                                                                                                                                                                                                                                                         +
WHEN 'Weekly' THEN '1 week'::INTERVAL                                                                                                                                                                                                                                                       +
WHEN 'Every 2 Weeks' THEN '2 weeks'::INTERVAL                                                                                                                                                                                                                                               +
WHEN 'Monthly' THEN '1 month'::INTERVAL                                                                                                                                                                                                                                                     +
WHEN 'Every 2 Months' THEN '2 months'::INTERVAL                                                                                                                                                                                                                                             +
WHEN 'Quarterly' THEN '3 months'::INTERVAL                                                                                                                                                                                                                                                  +
WHEN 'Every 6 Months' THEN '6 months'::INTERVAL                                                                                                                                                                                                                                             +
WHEN 'Annually' THEN '1 year'::INTERVAL                                                                                                                                                                                                                                                     +
ELSE '1 month'::INTERVAL -- Default to monthly if invalid                                                                                                                                                                                                                                   +
END;                                                                                                                                                                                                                                                                                          +
+
-- Calculate lease duration as an interval (fix: convert days to interval)                                                                                                                                                                                                                    +
lease_duration := COALESCE(                                                                                                                                                                                                                                                                   +
(NEW.end_date - NEW.start_date) * interval '1 day',                                                                                                                                                                                                                                         +
'12 months'::INTERVAL                                                                                                                                                                                                                                                                       +
);                                                                                                                                                                                                                                                                                            +
+
-- Generate payment records                                                                                                                                                                                                                                                                   +
INSERT INTO lease_period_payments (lease_id, period_start_date, due_date, total_amount, status)                                                                                                                                                                                               +
SELECT                                                                                                                                                                                                                                                                                        +
NEW.id,                                                                                                                                                                                                                                                                                     +
NEW.start_date + (n * payment_interval) AS period_start_date,                                                                                                                                                                                                                               +
(NEW.start_date + (NEW.payment_date - 1) * interval '1 day') + (n * payment_interval) AS due_date,                                                                                                                                                                                          +
NEW.rent_amount AS total_amount,                                                                                                                                                                                                                                                            +
'pending' AS status                                                                                                                                                                                                                                                                         +
FROM generate_series(                                                                                                                                                                                                                                                                         +
0,  -- Start at 0 for first period                                                                                                                                                                                                                                                          +
floor(extract(epoch FROM lease_duration) / extract(epoch FROM payment_interval))::int - 1                                                                                                                                                                                                   +
) AS n                                                                                                                                                                                                                                                                                        +
WHERE NEW.start_date + (n * payment_interval) < COALESCE(NEW.end_date, NEW.start_date + interval '12 months');                                                                                                                                                                                +
END IF;                                                                                                                                                                                                                                                                                         +
+
RETURN NEW;                                                                                                                                                                                                                                                                                     +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.oid_dist(oid, oid) RETURNS oid AS $CREATE OR REPLACE FUNCTION public.oid_dist(oid, oid)                                                                                                                                                                         +
RETURNS oid                                                                                                                                                                                                                                                                                      +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$oid_dist$function$                                                                                                                                                                                                                                             +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.refresh_payment_statuses() RETURNS void AS $CREATE OR REPLACE FUNCTION public.refresh_payment_statuses()                                                                                                                                                        +
RETURNS void                                                                                                                                                                                                                                                                                     +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
UPDATE lease_period_payments                                                                                                                                                                                                                                                                    +
SET status = CASE                                                                                                                                                                                                                                                                               +
WHEN due_date < CURRENT_DATE AND status != 'paid' THEN 'overdue'                                                                                                                                                                                                                              +
WHEN due_date >= CURRENT_DATE AND status != 'paid' THEN 'pending'                                                                                                                                                                                                                             +
ELSE status -- Preserve 'paid'                                                                                                                                                                                                                                                                +
END                                                                                                                                                                                                                                                                                             +
WHERE status != 'paid'; -- Skip already paid records to optimize                                                                                                                                                                                                                                +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.set_default_department_role() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.set_default_department_role()                                                                                                                                               +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
IF NEW.role_id IS NULL THEN                                                                                                                                                                                                                                                                     +
-- Set role_id to the id of the role named 'team_member'                                                                                                                                                                                                                                      +
SELECT id INTO NEW.role_id                                                                                                                                                                                                                                                                    +
FROM public.roles                                                                                                                                                                                                                                                                             +
WHERE name = 'team_member'                                                                                                                                                                                                                                                                    +
LIMIT 1;                                                                                                                                                                                                                                                                                      +
END IF;                                                                                                                                                                                                                                                                                         +
RETURN NEW;                                                                                                                                                                                                                                                                                     +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.subtract_payment_total() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.subtract_payment_total()                                                                                                                                                         +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
UPDATE lease_period_payments                                                                                                                                                                                                                                                                    +
SET total_amount = total_amount - OLD.amount                                                                                                                                                                                                                                                    +
WHERE lease_id = OLD.lease_id                                                                                                                                                                                                                                                                   +
AND period_start_date = OLD.period_start_date;                                                                                                                                                                                                                                                +
RETURN OLD;                                                                                                                                                                                                                                                                                     +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.sync_lease_charges_to_payments() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.sync_lease_charges_to_payments()                                                                                                                                         +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
DECLARE                                                                                                                                                                                                                                                                                           +
lease_start_date DATE;                                                                                                                                                                                                                                                                          +
lease_rent_amount NUMERIC(12,2);                                                                                                                                                                                                                                                                +
effective_start_date DATE;                                                                                                                                                                                                                                                                      +
BEGIN                                                                                                                                                                                                                                                                                             +
-- Log debugging information                                                                                                                                                                                                                                                                    +
RAISE NOTICE 'Processing lease charge: lease_id=%, charge_id=%, amount=%',                                                                                                                                                                                                                      +
NEW.lease_id, NEW.id, NEW.amount;                                                                                                                                                                                                                                                             +
+
-- Get lease info                                                                                                                                                                                                                                                                               +
SELECT start_date, rent_amount                                                                                                                                                                                                                                                                  +
INTO lease_start_date, lease_rent_amount                                                                                                                                                                                                                                                        +
FROM leases                                                                                                                                                                                                                                                                                     +
WHERE id = NEW.lease_id;                                                                                                                                                                                                                                                                        +
+
-- Handle NULL period_start_date by using lease start date or current date                                                                                                                                                                                                                      +
IF NEW.period_start_date IS NULL THEN                                                                                                                                                                                                                                                           +
effective_start_date := GREATEST(lease_start_date, CURRENT_DATE);                                                                                                                                                                                                                             +
+
-- Update the charge with the effective date                                                                                                                                                                                                                                                  +
UPDATE lease_charges                                                                                                                                                                                                                                                                          +
SET period_start_date = effective_start_date                                                                                                                                                                                                                                                  +
WHERE id = NEW.id;                                                                                                                                                                                                                                                                            +
+
-- Update the NEW record for the rest of the function                                                                                                                                                                                                                                         +
NEW.period_start_date := effective_start_date;                                                                                                                                                                                                                                                +
ELSE                                                                                                                                                                                                                                                                                            +
effective_start_date := NEW.period_start_date;                                                                                                                                                                                                                                                +
END IF;                                                                                                                                                                                                                                                                                         +
+
-- Update payment periods with this charge's amount                                                                                                                                                                                                                                             +
UPDATE lease_period_payments lpp                                                                                                                                                                                                                                                                +
SET total_amount = lease_rent_amount +                                                                                                                                                                                                                                                          +
COALESCE((                                                                                                                                                                                                                                                                                    +
SELECT SUM(amount)                                                                                                                                                                                                                                                                          +
FROM lease_charges                                                                                                                                                                                                                                                                          +
WHERE lease_id = NEW.lease_id                                                                                                                                                                                                                                                               +
AND period_start_date <= lpp.period_start_date                                                                                                                                                                                                                                            +
), 0)                                                                                                                                                                                                                                                                                         +
WHERE lpp.lease_id = NEW.lease_id                                                                                                                                                                                                                                                               +
AND lpp.period_start_date >= effective_start_date;                                                                                                                                                                                                                                            +
+
RETURN NEW;                                                                                                                                                                                                                                                                                     +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.time_dist(time without time zone, time without time zone) RETURNS interval AS $CREATE OR REPLACE FUNCTION public.time_dist(time without time zone, time without time zone)                                                                                      +
RETURNS interval                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$time_dist$function$                                                                                                                                                                                                                                            +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.ts_dist(timestamp without time zone, timestamp without time zone) RETURNS interval AS $CREATE OR REPLACE FUNCTION public.ts_dist(timestamp without time zone, timestamp without time zone)                                                                      +
RETURNS interval                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$ts_dist$function$                                                                                                                                                                                                                                              +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.tstz_dist(timestamp with time zone, timestamp with time zone) RETURNS interval AS $CREATE OR REPLACE FUNCTION public.tstz_dist(timestamp with time zone, timestamp with time zone)                                                                              +
RETURNS interval                                                                                                                                                                                                                                                                                 +
LANGUAGE c                                                                                                                                                                                                                                                                                       +
IMMUTABLE PARALLEL SAFE STRICT                                                                                                                                                                                                                                                                   +
AS '$libdir/btree_gist', $function$tstz_dist$function$                                                                                                                                                                                                                                            +
$ LANGUAGE c;
CREATE OR REPLACE FUNCTION public.update_lease_payment_amounts() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.update_lease_payment_amounts()                                                                                                                                             +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
DECLARE                                                                                                                                                                                                                                                                                           +
lease_rent_amount NUMERIC(12,2);                                                                                                                                                                                                                                                                +
BEGIN                                                                                                                                                                                                                                                                                             +
-- Get the lease's rent amount                                                                                                                                                                                                                                                                  +
SELECT rent_amount INTO lease_rent_amount                                                                                                                                                                                                                                                       +
FROM leases                                                                                                                                                                                                                                                                                     +
WHERE id = NEW.lease_id;                                                                                                                                                                                                                                                                        +
+
-- Handle NULL period_start_date by defaulting to the current month                                                                                                                                                                                                                             +
IF NEW.period_start_date IS NULL THEN                                                                                                                                                                                                                                                           +
NEW.period_start_date := date_trunc('month', CURRENT_DATE);                                                                                                                                                                                                                                   +
+
-- Update the record with the default date                                                                                                                                                                                                                                                    +
UPDATE lease_charges                                                                                                                                                                                                                                                                          +
SET period_start_date = NEW.period_start_date                                                                                                                                                                                                                                                 +
WHERE id = NEW.id;                                                                                                                                                                                                                                                                            +
END IF;                                                                                                                                                                                                                                                                                         +
+
-- For new charges, default to applying to all periods                                                                                                                                                                                                                                          +
UPDATE lease_period_payments                                                                                                                                                                                                                                                                    +
SET total_amount = lease_rent_amount + NEW.amount                                                                                                                                                                                                                                               +
WHERE lease_id = NEW.lease_id                                                                                                                                                                                                                                                                   +
AND period_start_date >= NEW.period_start_date;                                                                                                                                                                                                                                               +
+
RETURN NEW;                                                                                                                                                                                                                                                                                     +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.update_lease_statuses() RETURNS void AS $CREATE OR REPLACE FUNCTION public.update_lease_statuses()                                                                                                                                                              +
RETURNS void                                                                                                                                                                                                                                                                                     +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
UPDATE leases                                                                                                                                                                                                                                                                                   +
SET status = 'Ended'                                                                                                                                                                                                                                                                            +
WHERE status = 'Active'                                                                                                                                                                                                                                                                         +
AND end_date IS NOT NULL                                                                                                                                                                                                                                                                      +
AND end_date < CURRENT_DATE;                                                                                                                                                                                                                                                                  +
+
UPDATE leases                                                                                                                                                                                                                                                                                   +
SET status = 'Active'                                                                                                                                                                                                                                                                           +
WHERE status = 'Pending'                                                                                                                                                                                                                                                                        +
AND start_date <= CURRENT_DATE                                                                                                                                                                                                                                                                +
AND (end_date IS NULL OR end_date > CURRENT_DATE);                                                                                                                                                                                                                                            +
+
UPDATE leases                                                                                                                                                                                                                                                                                   +
SET status = 'Pending'                                                                                                                                                                                                                                                                          +
WHERE status = 'Active'                                                                                                                                                                                                                                                                         +
AND start_date > CURRENT_DATE;                                                                                                                                                                                                                                                                +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.update_modified_column() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.update_modified_column()                                                                                                                                                         +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
NEW.updated_at = NOW();                                                                                                                                                                                                                                                                       +
RETURN NEW;                                                                                                                                                                                                                                                                                   +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.update_payment_status() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.update_payment_status()                                                                                                                                                           +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
-- Update status based on due_date and current date                                                                                                                                                                                                                                             +
IF NEW.due_date < CURRENT_DATE AND NEW.status != 'paid' THEN                                                                                                                                                                                                                                    +
NEW.status := 'overdue';                                                                                                                                                                                                                                                                      +
ELSIF NEW.due_date >= CURRENT_DATE AND NEW.status != 'paid' THEN                                                                                                                                                                                                                                +
NEW.status := 'pending';                                                                                                                                                                                                                                                                      +
END IF;                                                                                                                                                                                                                                                                                         +
+
-- If status is 'paid', leave it unchanged                                                                                                                                                                                                                                                      +
RETURN NEW;                                                                                                                                                                                                                                                                                     +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.update_payment_total() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.update_payment_total()                                                                                                                                                             +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
UPDATE lease_period_payments                                                                                                                                                                                                                                                                    +
SET total_amount = total_amount + NEW.amount                                                                                                                                                                                                                                                    +
WHERE lease_id = NEW.lease_id                                                                                                                                                                                                                                                                   +
AND period_start_date = NEW.period_start_date;                                                                                                                                                                                                                                                +
RETURN NEW;                                                                                                                                                                                                                                                                                     +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.update_unit_status() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.update_unit_status()                                                                                                                                                                 +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
-- Determine the unit_id based on the trigger operation                                                                                                                                                                                                                                       +
DECLARE                                                                                                                                                                                                                                                                                       +
target_unit_id uuid;                                                                                                                                                                                                                                                                      +
BEGIN                                                                                                                                                                                                                                                                                         +
IF TG_OP = 'INSERT' OR TG_OP = 'UPDATE' THEN                                                                                                                                                                                                                                              +
target_unit_id := NEW.unit_id;                                                                                                                                                                                                                                                        +
ELSIF TG_OP = 'DELETE' THEN                                                                                                                                                                                                                                                               +
target_unit_id := OLD.unit_id;                                                                                                                                                                                                                                                        +
END IF;                                                                                                                                                                                                                                                                                   +
+
-- Check if there are any active leases for the unit                                                                                                                                                                                                                                      +
IF EXISTS (                                                                                                                                                                                                                                                                               +
SELECT 1                                                                                                                                                                                                                                                                              +
FROM leases                                                                                                                                                                                                                                                                           +
WHERE unit_id = target_unit_id                                                                                                                                                                                                                                                        +
AND status = 'Active'                                                                                                                                                                                                                                                                 +
) THEN                                                                                                                                                                                                                                                                                    +
-- Set status to 'occupied' if theres at least one active lease                                                                                                                                                                                                                      +
UPDATE units                                                                                                                                                                                                                                                                          +
SET status = 'occupied'                                                                                                                                                                                                                                                               +
WHERE id = target_unit_id;                                                                                                                                                                                                                                                            +
ELSE                                                                                                                                                                                                                                                                                      +
-- Set status to 'vacant' if no active leases exist                                                                                                                                                                                                                                   +
UPDATE units                                                                                                                                                                                                                                                                          +
SET status = 'vacant'                                                                                                                                                                                                                                                                 +
WHERE id = target_unit_id;                                                                                                                                                                                                                                                            +
END IF;                                                                                                                                                                                                                                                                                   +
END;                                                                                                                                                                                                                                                                                          +
RETURN NULL; -- Return value is ignored for AFTER triggers                                                                                                                                                                                                                                    +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION public.update_updated_at_column() RETURNS trigger AS $CREATE OR REPLACE FUNCTION public.update_updated_at_column()                                                                                                                                                     +
RETURNS trigger                                                                                                                                                                                                                                                                                  +
LANGUAGE plpgsql                                                                                                                                                                                                                                                                                 +
AS $function$                                                                                                                                                                                                                                                                                     +
BEGIN                                                                                                                                                                                                                                                                                             +
NEW.updated_at = CURRENT_TIMESTAMP;                                                                                                                                                                                                                                                           +
RETURN NEW;                                                                                                                                                                                                                                                                                   +
END;                                                                                                                                                                                                                                                                                              +
$function$                                                                                                                                                                                                                                                                                        +
$ LANGUAGE plpgsql;

CREATE TRIGGER update_announcement_schedules_modtime BEFORE UPDATE ON announcement_schedules FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_modified_column();
CREATE TRIGGER update_announcement_targets_modtime BEFORE UPDATE ON announcement_targets FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_modified_column();
CREATE TRIGGER update_announcement_types_modtime BEFORE UPDATE ON announcement_types FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_modified_column();
CREATE TRIGGER update_announcements_modtime BEFORE UPDATE ON announcements FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_modified_column();
CREATE TRIGGER update_bank_account_types_modified BEFORE UPDATE ON bank_account_types FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_modified_column();
CREATE TRIGGER update_bank_accounts_modified BEFORE UPDATE ON bank_accounts FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_modified_column();
CREATE TRIGGER update_communication_logs_modtime BEFORE UPDATE ON communication_logs FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_modified_column();
CREATE TRIGGER update_demo_requests_updated_at BEFORE UPDATE ON demo_requests FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER trg_set_default_department_role BEFORE INSERT ON departments FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION set_default_department_role();
CREATE TRIGGER update_expenses_updated_at BEFORE UPDATE ON expenses FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_financial_summaries_updated_at BEFORE UPDATE ON financial_summaries FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_invoice_items_updated_at BEFORE UPDATE ON invoice_items FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_invoice_payments_updated_at BEFORE UPDATE ON invoice_payments FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_invoices_updated_at BEFORE UPDATE ON invoices FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER sync_lease_charges_to_payments AFTER UPDATE ON lease_charges FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION sync_lease_charges_to_payments();
CREATE TRIGGER sync_lease_charges_to_payments AFTER INSERT ON lease_charges FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION sync_lease_charges_to_payments();
CREATE TRIGGER update_payment_status_trigger BEFORE UPDATE ON lease_period_payments FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_payment_status();
CREATE TRIGGER update_payment_status_trigger BEFORE INSERT ON lease_period_payments FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_payment_status();
CREATE TRIGGER after_delete_lease AFTER DELETE ON leases FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_unit_status();
CREATE TRIGGER after_insert_lease AFTER INSERT ON leases FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_unit_status();
CREATE TRIGGER after_update_lease AFTER UPDATE ON leases FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_unit_status();
CREATE TRIGGER handle_lease_deletion_trigger BEFORE DELETE ON leases FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION handle_lease_deletion();
CREATE TRIGGER manage_lease_payments_trigger AFTER INSERT ON leases FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION manage_lease_payments();
CREATE TRIGGER manage_lease_payments_trigger AFTER UPDATE ON leases FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION manage_lease_payments();
CREATE TRIGGER update_maintenance_requests_updated_at BEFORE UPDATE ON maintenance_requests FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_organizations_updated_at BEFORE UPDATE ON organizations FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_payment_schedules_modified BEFORE UPDATE ON payment_schedules FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_modified_column();
CREATE TRIGGER update_payment_transactions_modified BEFORE UPDATE ON payment_transactions FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_modified_column();
CREATE TRIGGER trigger_check_single_assignee BEFORE INSERT ON task_assignees FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION check_single_assignee_for_ticket();
CREATE TRIGGER update_team_members_modtime BEFORE UPDATE ON team_members FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_modified_column();
CREATE TRIGGER before_delete_unit BEFORE DELETE ON units FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION ensure_property_has_units();
CREATE TRIGGER before_update_unit_property BEFORE UPDATE ON units FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION ensure_property_has_units();
CREATE TRIGGER update_user_profiles_updated_at BEFORE UPDATE ON user_profiles FOR EACH ROW EXECUTE FUNCTION EXECUTE FUNCTION update_updated_at_column();

ALTER TABLE property_images ENABLE ROW LEVEL SECURITY;
ALTER TABLE rental_application_documents ENABLE ROW LEVEL SECURITY;
ALTER TABLE rental_applications ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Organizations are viewable by organization members" ON organizations FOR r USING ((auth.uid() IN ( SELECT user_profiles.id                                                  +
FROM user_profiles                                                                                                                                                                      +
WHERE (user_profiles.organization_id = organizations.id))));
CREATE POLICY "Allow users with create property permission in organization" ON properties FOR a TO authenticated WITH CHECK ((EXISTS ( SELECT 1                                            +
FROM (user_roles                                                                                                                                                                        +
JOIN roles ON ((user_roles.role_id = roles.id)))                                                                                                                                      +
WHERE ((user_roles.user_id = auth.uid()) AND (user_roles.organization_id = properties.organization_id) AND (((roles.permissions ->> 'can_create_properties'::text))::boolean = true)))));
CREATE POLICY "Allow all operations for authenticated users" ON property_images FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "Enable delete for authenticated users only" ON rental_application_documents FOR d USING (true);
CREATE POLICY "Enable insert for authenticated users only" ON rental_application_documents FOR a WITH CHECK (true);
CREATE POLICY "Enable read access for all users" ON rental_application_documents FOR r USING (true);
CREATE POLICY "Enable update for authenticated users only" ON rental_application_documents FOR w USING (true) WITH CHECK (true);
CREATE POLICY "Enable delete for authenticated users only" ON rental_applications FOR d USING (true);
CREATE POLICY "Enable insert for authenticated users only" ON rental_applications FOR a WITH CHECK (true);
CREATE POLICY "Enable read access for all users" ON rental_applications FOR r USING (true);
CREATE POLICY "Enable update for authenticated users only" ON rental_applications FOR w USING (true) WITH CHECK (true);
CREATE POLICY "Enable insert for authenticated users" ON user_profiles FOR a TO authenticated WITH CHECK (true);
CREATE POLICY "Users can view profiles in their organization" ON user_profiles FOR r USING ((organization_id IN ( SELECT user_profiles_1.organization_id                                   +
FROM user_profiles user_profiles_1                                                                                                                                                      +
WHERE (user_profiles_1.id = auth.uid()))));